<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkillNeast Courses</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Open+Sans:wght@300;400;600;700&family=Comfortaa:wght@700;800&family=Poppins:wght@700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* This style block ensures the loading screen shows immediately and hides the main content */
        body.loading-active > *:not(.loading-screen-overlay):not(script):not(style) {
            visibility: hidden;
            opacity: 0;
        }
        .loading-screen-overlay {
            /* This is visible by default when the page loads */
            display: flex;
        }
    </style>
    <style>
        :root {
            /* Premium Colors (Dark Theme Defaults) */
            --primary-dark: #1A2B3C;
            --accent-teal: #00ADB5;
            --secondary-light: #2c2c2c;
            --text-dark: #f0f0f0;
            --text-light: #b0b0b0;
            --highlight-gold: #FFD700;
            --success-green: #4CAF50;
            --error-red: #EF5350;
            --white: #ffffff;
            --border-color: rgba(255, 255, 255, 0.08);
            --cyan-glow-color: rgba(0, 173, 181, 0.5);
            --dark-bg-gradient-start: #000000;
            --dark-bg-gradient-end: #1A1A1A;
            /* Image-specific colors for lesson-item and player view */
            --player-bg-color: #1A2B3C;
            --player-section-bg: #222222;
            --player-meta-bg: #282828;
            --timeline-btn-bg: #4CAF50;
            --comments-btn-bg: #007bff;
            --watch-later-btn-bg: #6c757d;
            /* Shadows & Radii */
            --shadow-light: 0 4px 12px rgba(0, 0, 0, 0.2);
            --shadow-medium: 0 10px 30px rgba(0, 0, 0, 0.35);
            --shadow-popup: 0 15px 40px rgba(0, 0, 0, 0.5);
            --border-radius-main: 25px;
            --border-radius-card: 15px;
            --border-radius-input: 10px;
            --border-radius-button: 30px;

            /* Slider Menu Variables */
            --slider-bg: #1A1A1A;
            --slider-item-hover: #2c2c2c;
            --slider-text-color: var(--text-dark);
            --slider-icon-color: var(--accent-teal);
            --slider-border-color: rgba(255, 255, 255, 0.1);
        }

        /* --- MODIFIED: Loading Screen Styles --- */
        .loading-screen-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #1a1a1a; /* Dark gray background */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            font-family: 'Orbitron', sans-serif;
            transition: opacity 0.5s ease-out;
            opacity: 1;
        }

        .loading-screen-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        @keyframes pulseGlow {
            0%, 100% {
                transform: scale(1);
                filter: drop-shadow(0 0 5px var(--cyan-glow-color));
            }
            50% {
                transform: scale(1.05);
                filter: drop-shadow(0 0 15px var(--cyan-glow-color));
            }
        }

        .loading-logo {
            width: 230px;
            height: 230px;
            margin-bottom: 20px;
            animation: pulseGlow 3.5s infinite ease-in-out;
        }

        .loading-name {
            font-size: 2.5em;
            font-weight: 800;
            color: #E0E0E0;
            letter-spacing: 4px;
            margin: 0 0 25px 0;
            text-shadow: 0 0 9px var(--cyan-glow-color);
            background: linear-gradient(90deg, #ADD8E6, #00BFFF, #87CEEB, #ADD8E6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 200% 100%;
            animation: moveGradient 4s linear infinite;
        }
        
        @keyframes moveGradient {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }

        .loading-progress-bar-container {
            width: 90%;
            max-width: 400px;
            height: 12px; /* MODIFIED: Increased height */
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 6px; /* MODIFIED: Adjusted radius */
            border: 1px solid var(--accent-teal);
            padding: 3px; /* MODIFIED: Adjusted padding */
            box-shadow: 0 0 10px rgba(0, 173, 181, 0.3);
            margin-bottom: 20px;
        }

        .loading-progress-bar {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, var(--accent-teal), #87CEFA);
            border-radius: 4px; /* MODIFIED: Adjusted radius */
            animation: fillProgress 3s ease-out forwards;
        }

        @keyframes fillProgress {
            from { width: 0%; }
            to { width: 100%; }
        }
        
        /* NEW: Animation for text glow */
        @keyframes textShine {
            0% { text-shadow: 0 0 5px rgba(173, 216, 230, 0.4); } /* Light blue glow */
            50% { text-shadow: 0 0 15px rgba(173, 216, 230, 0.9); } /* Brighter, wider glow */
            100% { text-shadow: 0 0 5px rgba(173, 216, 230, 0.4); }
        }

        .loading-tagline {
            font-size: 0.9em; /* MODIFIED: Decreased font size */
            font-weight: 400;
            color: var(--text-light);
            letter-spacing: 2px;
            text-transform: uppercase;
            opacity: 0;
            /* MODIFIED: Combined animations */
            animation: fadeInText 2s ease-in 1.5s forwards, textShine 1s infinite linear;
        }
        
        @keyframes fadeInText {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        /* --- END: Loading Screen Styles --- */

        body {
            font-family: 'Open Sans', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--secondary-light);
            color: var(--text-dark);
            line-height: 1.8;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
            padding-bottom: 90px;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        img {
            pointer-events: none;
            -webkit-user-drag: none;
            user-drag: none;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: auto;
            padding: 0 15px;
        }

        .top-navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 25px;
            background: linear-gradient(to right, var(--dark-bg-gradient-start), var(--dark-bg-gradient-end));
            box-shadow: var(--shadow-medium);
            position: relative;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            border-bottom-left-radius: var(--border-radius-main);
            border-bottom-right-radius: var(--border-radius-main);
            transition: background 0.3s ease, box-shadow 0.3s ease;
        }
        .top-navbar .menu-icon, .top-navbar .telegram-icon, .top-navbar .notification-icon {
            font-size: 1.8em;
            color: var(--white);
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            width: 52px;
            height: 52px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease, color 0.3s ease;
            margin: 0;
            flex-shrink: 0;
        }

        .top-navbar .telegram-icon {
            padding-right: 5px;
        }
        .top-navbar .menu-icon {
            padding-left: 5px;
        }
        .top-navbar .notification-icon {
            position: relative;
            margin-left: 10px; /* Space from telegram icon */
        }
        .top-navbar .notification-icon .badge {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: var(--error-red);
            color: white;
            border-radius: 50%;
            padding: 3px 6px;
            font-size: 0.7em;
            min-width: 20px;
            text-align: center;
            line-height: 1;
            transform: translate(50%, -50%);
            display: none; /* Hide by default if count is 0 */
        }
        /* NEW: Notification ringing animation */
        @keyframes ring {
            0% { transform: rotate(0); }
            20% { transform: rotate(-25deg); }
            40% { transform: rotate(25deg); }
            60% { transform: rotate(-15deg); }
            80% { transform: rotate(15deg); }
            100% { transform: rotate(0); }
        }

        .top-navbar .notification-icon.ringing {
            animation: ring 1s ease-in-out infinite; /* Continuous ringing */
        }

        .top-navbar .notification-icon.active {
            color: var(--accent-teal); /* Blue color on active */
            box-shadow: 0 0 15px var(--accent-teal); /* Glow effect */
        }

        .top-navbar .menu-icon:hover, .top-navbar .telegram-icon:hover, .top-navbar .notification-icon:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }
        .top-navbar .app-logo {
            display: flex;
            flex-direction: row;
            align-items: center;
            padding: 8px 18px;
            background-color: var(--primary-dark);
            border-radius: var(--border-radius-button);
            box-shadow: var(--shadow-light);
            cursor: pointer;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            overflow: hidden;
            flex-grow: 0;
            margin: 0;
            justify-content: center;
            z-index: 1;
        }
        .top-navbar .app-logo:hover {
            background-color: #2F4156;
        }
        .top-navbar .app-logo img#skillNeastLogo {
            height: 34px;
            margin-right: 8px;
            margin-bottom: 0;
            transition: transform 1s linear;
        }
        .top-navbar .app-logo img#skillNeastLogo.rotating {
            animation: rotate360 1s linear forwards;
        }
        @keyframes rotate360 {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .top-navbar .app-logo .text-wrapper {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        .top-navbar .app-logo .main-title {
            font-family: 'Poppins', sans-serif;
            font-weight: 800;
            font-size: 1.5em;
            letter-spacing: 1.2px;
            background: linear-gradient(90deg, #FF6F61, #FFD700, #4CAF50, #00ADB5, #3F51B5, #9C27B0);
            -webkit-background-clip: text;
            color: transparent;
            display: inline-block;
            animation: rainbowText 5s linear infinite;
            background-size: 200% 100%;
            line-height: 1;
        }

        @keyframes rainbowText {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }
        /* New Tagline Styles */
        .top-navbar .app-logo .tagline {
            font-family: 'Open Sans', sans-serif;
            font-size: 0.65em;
            font-weight: 600;
            color: var(--text-light);
            text-align: left;
            animation: floatUpDown 2s infinite ease-in-out;
            white-space: nowrap;
            transition: color 0.3s ease;
            line-height: 1;
        }

        /* --- Main Content Area --- */
        .main-content {
            padding: 30px 20px;
            min-height: calc(100vh - 180px);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* --- Welcome Banner --- */
        .welcome-banner {
            background: linear-gradient(135deg, var(--primary-dark), #2F4156);
            color: var(--text-dark);
            padding: 28px;
            border-radius: var(--border-radius-main);
            box-shadow: 0 0 10px rgba(0, 173, 181, 0.6),
                        0 0 20px rgba(0, 173, 181, 0.4),
                        0 10px 30px rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            border: 1px solid rgba(0, 173, 181, 0.1);
            position: relative;
            transition: background 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
        }
        .welcome-banner .greeting {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.9em;
            font-weight: 700;
            display: flex;
            align-items: center;
            color: var(--text-dark);
            transition: color 0.3s ease;
        }
        .welcome-banner .greeting i {
            margin-right: 10px;
            color: var(--error-red);
            font-size: 1.5em;
            vertical-align: middle;
        }
        .welcome-banner .fire-icon {
            font-size: 2.5em;
            color: #FF5722;
            animation: pulse 1s infinite alternate;
            vertical-align: middle;
            margin-left: 0;
        }
        .role-sticker {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--accent-teal);
            color: var(--white);
            font-family: 'Montserrat', sans-serif;
            font-size: 0.7em;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 12px;
            box-shadow: var(--shadow-light);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* --- Quote Section (Updated for Premium Look with Cyan Glow) --- */
        .quote-section {
            background: linear-gradient(135deg, #2A2A2A, #222222);
            padding: 30px;
            border-radius: var(--border-radius-main);
            box-shadow: 0 0 15px var(--cyan-glow-color),
                        0 10px 30px rgba(0, 0, 0, 0.35);
            text-align: center;
            margin-bottom: 30px;
            border: 2px solid var(--accent-teal);
            position: relative;
            overflow: hidden;
            transition: box-shadow 0.3s ease-in-out, background 0.3s ease, border-color 0.3s ease;
        }
        .quote-section::before {
            content: '“';
            position: absolute;
            top: 10px;
            left: 20px;
            font-family: serif;
            font-size: 5em;
            color: rgba(255, 255, 255, 0.08);
            z-index: 0;
            line-height: 0.5;
        }
        .quote-section::after {
            content: '”';
            position: absolute;
            bottom: -20px;
            right: 20px;
            font-family: serif;
            font-size: 5em;
            color: rgba(255, 255, 255, 0.08);
            z-index: 0;
            line-height: 0.5;
        }
        .quote-section .quote-text {
            font-family: 'Open Sans', sans-serif;
            font-style: italic;
            font-size: 1.25em;
            margin-bottom: 18px;
            color: var(--text-dark);
            position: relative;
            z-index: 1;
            animation: quoteSlideIn 0.8s cubic-bezier(0.23, 1, 0.32, 1) forwards;
            padding: 0 10px;
            transition: color 0.3s ease;
        }
        @keyframes quoteSlideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .quote-section .quote-author {
            font-weight: 700;
            color: var(--highlight-gold);
            font-size: 1.1em;
            position: relative;
            z-index: 1;
            animation: quoteAuthorFadeIn 1s ease-out forwards;
            transition: color 0.3s ease;
        }
        @keyframes quoteAuthorFadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .quote-section .quote-emoji {
            font-size: 1.3em;
            margin-left: 10px;
            display: inline-block;
            z-index: 1;
            animation: emojiPopAndGlow 0.6s ease-out forwards, floatUpDown 2s infinite ease-in-out;
        }
        @keyframes emojiPopAndGlow {
            0% { transform: scale(0); opacity: 0; text-shadow: none; }
            50% { transform: scale(1.3); opacity: 1; text-shadow: 0 0 8px var(--cyan-glow-color); }
            100% { transform: scale(1); opacity: 1; text-shadow: none; }
        }
        @keyframes floatUpDown {
            0% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0); }
        }

        /* Fullscreen Image Overlay */
        .fullscreen-image-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2500;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .fullscreen-image-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .fullscreen-image-overlay img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            cursor: zoom-out;
        }

        .fullscreen-image-close-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 2.5em;
            color: #fff;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .fullscreen-image-close-button:hover {
            color: var(--error-red);
        }

        /* Global Notice Popup Overlay (promotional popup) */
        .global-notice-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .global-notice-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .global-notice-popup {
            background-color: #f0f0f0;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.5);
            text-align: center;
            width: 90%;
            max-width: 450px;
            position: relative;
            color: #333;
            transform: translateY(20px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .global-notice-overlay.active .global-notice-popup {
            transform: translateY(0);
            opacity: 1;
        }

        .global-notice-close-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 2em;
            color: #999;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .global-notice-close-button:hover {
            color: #555;
        }

        .global-notice-popup .action-required-header {
            background-color: #ef5350;
            color: #fff;
            padding: 10px 15px;
            border-radius: 8px;
            margin: -20px -20px 20px -20px;
            font-weight: 700;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .global-notice-popup .action-required-header i {
            font-size: 1.5em;
            color: #FFD700;
        }

        .global-notice-popup p {
            font-size: 0.95em;
            line-height: 1.5;
            margin-bottom: 20px;
            color: #444;
        }

        .global-notice-popup .join-button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease;
            width: 100%;
            margin-bottom: 20px;
        }

        .global-notice-popup .join-button:hover {
            background-color: #45a049;
            transform: translateY(-2px);
        }

        .global-notice-popup .notice-reaction-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px solid #ddd;
        }

        .global-notice-popup .reaction-icon-notice {
            font-size: 1.4em;
            cursor: pointer;
            padding: 5px 8px;
            border-radius: 5px;
            transition: background-color 0.2s ease;
            user-select: none;
            display: flex;
            align-items: center;
        }

        .global-notice-popup .reaction-icon-notice span {
            font-size: 0.8em;
            margin-left: 5px;
            color: #666;
        }

        .global-notice-popup .reaction-icon-notice:hover {
            background-color: #e0e0e0;
        }

        .global-notice-popup .reaction-icon-notice.reacted {
            background-color: #c9e6f1;
            color: var(--accent-teal);
        }

        .global-notice-popup .reaction-emoji {
            font-size: 1.5em;
            line-height: 1;
        }

        /* Telegram Channels Banner (WE NEED) - Premium Look */
        .telegram-channels-banner {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border-radius: var(--border-radius-main);
            box-shadow: var(--shadow-medium);
            padding: 25px;
            text-align: center;
            margin-top: 30px;
            color: #333;
            font-family: 'Montserrat', sans-serif;
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }
        .telegram-channels-banner::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            filter: blur(15px);
        }
        .telegram-channels-banner::after {
            content: '';
            position: absolute;
            bottom: -10px;
            right: -10px;
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            filter: blur(20px);
        }

        .telegram-channels-banner .banner-title {
            font-size: 1.8em;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #C0392B;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            z-index: 1;
        }
        .telegram-channels-banner h2 {
            font-size: 1.5em;
            font-weight: 700;
            color: #4A4A4A;
            margin: 0;
            line-height: 1.2;
            z-index: 1;
        }
        .telegram-channels-banner .channel-list {
            text-align: center;
            font-size: 1em;
            font-weight: 600;
            line-height: 2;
            color: #666;
            z-index: 1;
        }
        .telegram-channels-banner .channel-list span {
            display: block;
            margin-bottom: 5px;
        }
        .telegram-channels-banner .channel-list i {
            margin-right: 8px;
            color: #007bff;
        }
        .telegram-channels-banner .click-here-button {
            background-color: #007bff;
            color: white;
            padding: 12px 25px;
            border-radius: 30px;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            z-index: 1;
        }
        .telegram-channels-banner .click-here-button:hover {
            background-color: #0056b3;
            transform: translateY(-3px);
        }
        .telegram-channels-banner .your-support-text {
            font-size: 1.2em;
            font-weight: 700;
            color: #C0392B;
            margin-top: 15px;
            z-index: 1;
        }

        /* Discover Notice (Namo Buddhaya Everyone) - Premium Look */
        .discover-notice {
            background: linear-gradient(135deg, #1A2B3C, #000000);
            border-radius: var(--border-radius-main);
            box-shadow: var(--shadow-medium);
            padding: 30px;
            margin-top: 30px;
            color: var(--text-dark);
            font-family: 'Open Sans', sans-serif;
            text-align: left;
            display: none;
            position: relative;
            border: 1px solid var(--border-color);
        }
        .discover-notice .discover-image {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .discover-notice h4 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5em;
            font-weight: 700;
            color: var(--highlight-gold);
            margin-bottom: 15px;
            text-align: center;
        }
        .discover-notice ol {
            padding-left: 20px;
            margin-bottom: 0;
            color: var(--text-light);
        }
        .discover-notice ol li {
            margin-bottom: 10px;
            font-size: 1em;
            line-height: 1.6;
        }
        .discover-notice .emoji-inline {
            margin-right: 8px;
            font-size: 1.1em;
        }
        /* Discover Notice Reactions */
        .discover-notice-reactions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        .discover-notice-reactions .reaction-icon-discover {
            font-size: 1.5em;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 8px;
            transition: background-color 0.2s ease, transform 0.2s ease, color 0.2s ease;
            user-select: none;
            display: flex;
            align-items: center;
            color: var(--text-light);
        }
        .discover-notice-reactions .reaction-icon-discover span {
            font-size: 0.9em;
            margin-left: 8px;
            color: var(--text-light);
        }
        .discover-notice-reactions .reaction-icon-discover:hover {
            background-color: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }
        .discover-notice-reactions .reaction-icon-discover.reacted {
            background-color: rgba(0, 173, 181, 0.3);
            color: var(--accent-teal);
            transform: scale(1.05);
        }
        .discover-notice-reactions .reaction-emoji {
            font-size: 1.8em;
            line-height: 1;
        }

        /* --- Home View (Initial grid of course categories/batches) --- */
        #home-view {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            padding: 0px;
        }
        
        /* Container for dynamically loaded categories */
        #dynamic-categories-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            grid-column: 1 / -1;
        }

        .course-category-item {
            background-color: #333333;
            border-radius: 18px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            padding: 0;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease, background-color 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            align-items: stretch;
            min-height: 180px;
            border: 1px solid var(--border-color);
            overflow: hidden;
            width: 100%;
        }
        .course-category-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            border-color: var(--accent-teal);
        }
        .course-category-item:active {
            transform: scale(0.98);
        }
        .course-category-item.long-press {
            transform: scale(0.95) !important;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5) !important;
            transition-duration: 0.1s;
        }

        .course-category-item .image-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: inherit;
            overflow: hidden;
            z-index: 1;
        }
        .course-category-item .image-container img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            object-position: center;
            padding: 10px;
            box-sizing: border-box;
        }
        .course-category-item .content-overlay {
            position: relative;
            z-index: 2;
            background: rgba(0, 0, 0, 0.4);
            color: var(--white);
            padding: 10px 15px;
            text-align: center;
            box-sizing: border-box;
            width: 100%;
            margin-top: auto;
            transition: color 0.3s ease;
        }
        .course-category-item .content-overlay .category-name {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 1.2em;
            line-height: 1.2;
            margin-bottom: 0;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
        }
        .course-category-item .new-tag {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #FFC107;
            color: var(--white);
            font-size: 0.7em;
            font-weight: 700;
            padding: 4px 8px;
            border-radius: 5px;
            text-transform: uppercase;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 3;
        }

        .surprise-button {
            grid-column: 1 / -1;
            background: linear-gradient(90deg, #FF6F61, #FF5722);
            color: var(--white);
            padding: 20px;
            border-radius: var(--border-radius-main);
            box-shadow: var(--shadow-medium);
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.3em;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        .surprise-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.4);
            background: linear-gradient(90deg, #FF5722, #FF6F61);
        }
        .surprise-button:active {
            transform: scale(0.98);
        }
        .surprise-button i {
            font-size: 1.5em;
            animation: bounce 1s infinite alternate;
        }

        /* NEW: Class for the Request Courses button */
        .request-courses-button {
            background: linear-gradient(90deg, #1e3c72 0%, #2a5298 100%);
            color: var(--white);
            padding: 15px 25px;
            border-radius: var(--border-radius-button);
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: var(--shadow-medium);
            border: none;
        }
        .request-courses-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(42, 82, 152, 0.4);
        }


        .original-price-strikethrough {
            text-decoration: line-through;
            color: var(--text-light);
            font-size: 0.9em;
            margin-left: 8px;
        }
        .free-price {
            font-weight: 700;
            color: var(--success-green);
        }
        .batch-description-feature {
            display: flex;
            align-items: flex-start;
            margin-bottom: 5px;
            color: var(--text-light);
        }
        .batch-description-feature i {
            margin-right: 8px;
            color: var(--success-green);
            font-size: 1.1em;
            line-height: inherit;
        }

        @media (max-width: 600px) {
            #home-view {
                grid-template-columns: 1fr;
            }
            #dynamic-categories-container {
                grid-template-columns: 1fr;
            }
            .surprise-button {
                font-size: 1.1em;
                padding: 15px;
                gap: 10px;
                margin-top: 15px;
            }
            .surprise-button i {
                font-size: 1.3em;
            }
            .course-category-item {
                min-height: 160px;
            }
            .course-category-item .image-container img { padding: 5px; }
            .course-category-item .content-overlay { padding: 10px; }
            .course-category-item .category-name { font-size: 0.95em;}

            .quote-section {
                padding: 20px;
            }
            .quote-section .quote-text {
                font-size: 1.1em;
            }
            .quote-section .quote-author {
                font-size: 0.95em;
            }
        }

        .favorites-section-home-card {
            grid-column: 1 / -1;
            background-color: #333333;
            border-radius: var(--border-radius-main);
            box-shadow: var(--shadow-light);
            padding: 25px;
            margin-top: 30px;
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.3s ease;
            border: 1px solid var(--border-color);
        }
        .favorites-section-home-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }
        .favorites-section-home-card:active {
            transform: scale(0.98);
        }
        .favorites-section-home-card.long-press {
            transform: scale(0.95) !important;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5) !important;
            transition-duration: 0.1s;
        }
        .favorites-section-home-card h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8em;
            font-weight: 700;
            color: var(--text-dark);
            margin-top: 0;
            margin-bottom: 15px;
            transition: color 0.3s ease;
        }
        .favorites-section-home-card .fav-icon {
            font-size: 3em;
            color: var(--error-red);
            margin-bottom: 10px;
        }
        .favorites-section-home-card p {
            font-size: 1em;
            color: var(--text-light);
            margin-bottom: 10px;
            transition: color 0.3s ease;
        }
        .favorites-section-home-card .fav-count {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.2em;
            font-weight: 700;
            color: var(--accent-teal);
            transition: color 0.3s ease;
        }

        .telegram-card {
            grid-column: 1 / -1;
            background-color: #333333;
            border-radius: var(--border-radius-card);
            box-shadow: var(--shadow-light);
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease, background-color 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 150px;
            border: 1px solid var(--border-color);
            margin-top: 20px;
            color: var(--text-dark);
        }
        .telegram-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
            border-color: #0088cc;
        }
        .telegram-card:active {
            transform: scale(0.98);
        }
        .telegram-card.long-press {
            transform: scale(0.95) !important;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5) !important;
            transition-duration: 0.1s;
        }
        .telegram-card .telegram-icon-large {
            font-size: 3em;
            color: #0088cc;
            margin-bottom: 10px;
        }
        .telegram-card .telegram-text {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            font-size: 1.2em;
            color: var(--text-dark);
            transition: color 0.3s ease;
        }

        #new-batches-view {
            display: none;
            padding: 0px;
        }
        #new-batches-view .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }
        #new-batches-view .back-button {
            background-color: transparent;
            border: none;
            font-size: 2em;
            color: var(--text-dark);
            cursor: pointer;
            margin-right: 18px;
            transition: color 0.2s ease, transform 0.2s ease;
        }
        #new-batches-view .back-button:hover {
            color: var(--accent-teal);
            transform: translateX(-5px);
        }
        #new-batches-view h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.2em;
            font-weight: 700;
            color: var(--text-dark);
            margin: 0;
            flex-grow: 1;
            transition: color 0.3s ease;
        }
        .search-bar-container {
            display: flex;
            align-items: center;
            background-color: #222222;
            border-radius: var(--border-radius-main);
            box-shadow: var(--shadow-light);
            padding: 8px 15px;
            margin-bottom: 25px;
            border: 1px solid var(--border-color);
            transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .search-bar-container input {
            flex-grow: 1;
            border: none;
            outline: none;
            padding: 8px 10px;
            font-size: 1em;
            font-family: 'Open Sans', sans-serif;
            color: var(--text-dark);
            background-color: transparent;
            transition: color 0.3s ease;
        }
        .search-bar-container .search-icon {
            font-size: 1.2em;
            color: var(--text-light);
            margin-right: 10px;
            transition: color 0.3s ease;
        }
        .search-bar-container .search-button {
            background-color: var(--accent-teal);
            color: var(--white);
            border: none;
            border-radius: var(--border-radius-button);
            padding: 10px 20px;
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        .search-bar-container .search-button:hover {
            background-color: #00939b;
        }

        .batch-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .batch-card {
            background-color: #333333;
            border-radius: var(--border-radius-card);
            box-shadow: var(--shadow-light);
            overflow: hidden;
            border: 1px solid #444444;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.3s ease, border-color 0.3s ease;
        }
        .batch-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }
        .batch-card:active {
            transform: scale(0.98);
        }
        .batch-card.long-press {
            transform: scale(0.95) !important;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5) !important;
            transition-duration: 0.1s;
        }
        .batch-card-header {
            position: relative;
            background-color: var(--accent-teal);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--white);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.1em;
            font-weight: 600;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        /* NEW: Batch card header updates for badges and icon positioning */
        .batch-card-header {
            display: flex;
            align-items: center; /* Align items vertically */
            justify-content: flex-start; /* Start from the left */
            gap: 10px; /* Space between elements */
            position: relative; /* For badges positioning */
        }

        .batch-card-header .icons {
            font-size: 1.2em;
            display: flex; /* Allow icons to align horizontally */
            align-items: center;
            position: absolute; /* Position to the left of the title */
            left: 15px; /* Adjust as needed */
        }
        
        .batch-card-header .icons i {
            margin-right: 15px; /* Space from the title */
            cursor: pointer;
            transition: color 0.2s ease, transform 0.2s ease;
        }
        /* Adjusted for left alignment */
        .batch-card-header .icons i.fas.fa-heart {
            color: var(--error-red);
            transform: scale(1.1);
            margin-left: 0; /* Remove extra left margin */
        }
        .batch-card-header .icons i:hover {
            transform: scale(1.2);
        }
        .batch-card-header .batch-title-wrapper {
            display: flex;
            flex-direction: column;
            flex-grow: 1; /* Title takes remaining space */
            text-align: left;
            margin-left: 50px; /* Space for the heart icon */
        }
        .batch-card-header .batch-title {
            margin: 0;
            font-size: 1.2em; /* Ensure title is readable */
            line-height: 1.2;
        }

        .batch-card-header .batch-badges {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px; /* Space between badges */
        }
        .batch-card-header .batch-badges .badge {
            font-size: 0.7em;
            padding: 4px 8px;
            border-radius: 5px;
            font-weight: 700;
            text-transform: uppercase;
        }
        .batch-card-header .batch-badges .badge.new {
            background-color: #FFC107;
            color: #333;
        }
        .batch-card-header .batch-badges .badge.old {
            background-color: #6c757d; /* Grey for OLD, if you choose to show it */
            color: #fff;
        }
        .batch-card-header .batch-badges .badge.free {
            background-color: var(--success-green);
            color: var(--white);
        }
        .batch-card-header .batch-badges .badge.paid {
            background-color: var(--error-red);
            color: var(--white);
        }
        /* END NEW BATCH CARD HEADER */


        .batch-card-body {
            padding: 20px;
            transition: color 0.3s ease;
        }
        .batch-card-body .batch-image-container {
            width: calc(100% + 40px);
            height: 220px;
            margin: -20px -20px 15px -20px;
            border-radius: 0;
            overflow: hidden;
            position: relative;
        }
        .batch-card-body .batch-image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .batch-card-body .batch-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.6em;
            font-weight: 700;
            color: var(--text-dark);
            margin-top: 0;
            margin-bottom: 10px;
            transition: color 0.3s ease;
        }
        .batch-card-body .batch-description {
            font-size: 0.95em;
            color: var(--text-light);
            margin-bottom: 15px;
            line-height: 1.5;
            text-align: justify;
            transition: color 0.3s ease;
        }
        .batch-card-body .lets-roar-button {
            background-color: var(--primary-dark);
            color: var(--white);
            padding: 15px 25px;
            border-radius: var(--border-radius-button);
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: var(--shadow-light);
            margin-top: 15px;
        }
        .batch-card-body .lets-roar-button:hover {
            background-color: #2F4156;
            transform: translateY(-2px);
        }
        .batch-card-body .lets-roar-button i {
            font-size: 1.2em;
        }

        .batch-card-body .access-content-button {
            background-color: #17a2b8;
            color: var(--white);
            padding: 15px 25px;
            border-radius: var(--border-radius-button);
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: var(--shadow-light);
            margin-top: 15px;
        }
        .batch-card-body .access-content-button:hover {
            background-color: #138496;
            transform: translateY(-2px);
        }
        .batch-card-body .access-content-button i {
            font-size: 1.2em;
            animation: pulse 1s infinite alternate;
        }


        #favorites-view {
            display: none;
            padding: 0px;
        }
        #favorites-view .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }
        #favorites-view .back-button {
            background-color: transparent;
            border: none;
            font-size: 2em;
            color: var(--text-dark);
            cursor: pointer;
            margin-right: 18px;
            transition: color 0.2s ease, transform 0.2s ease;
        }
        #favorites-view .back-button:hover {
            color: var(--accent-teal);
            transform: translateX(-5px);
        }
        #favorites-view h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.2em;
            font-weight: 700;
            color: var(--text-dark);
            margin: 0;
            flex-grow: 1;
            transition: color 0.3s ease;
        }
        .promotional-banner {
            display: none;
        }
        .favorite-batch-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .no-favorites-message-view {
            font-size: 1.2em;
            color: var(--text-light);
            text-align: center;
            padding: 40px 20px;
            background-color: #333333;
            border-radius: var(--border-radius-card);
            box-shadow: var(--shadow-light);
            margin-top: 20px;
            border: 1px solid var(--border-color);
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .partition {
            display: none;
        }

        #sections-view {
            display: none;
            padding: 0px;
        }
        #sections-view .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }
        #sections-view .back-button {
            background-color: transparent;
            border: none;
            font-size: 2em;
            color: var(--text-dark);
            cursor: pointer;
            margin-right: 18px;
            transition: color 0.2s ease, transform 0.2s ease;
        }
        #sections-view .back-button:hover {
            color: var(--accent-teal);
            transform: translateX(-5px);
        }
        #sections-view h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.2em;
            font-weight: 700;
            color: var(--text-dark);
            margin: 0;
            flex-grow: 1;
            transition: color 0.3s ease;
        }
        .sections-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .section-item {
            background: linear-gradient(135deg, rgba(0, 173, 181, 0.1), rgba(0, 173, 181, 0.05));
            border-radius: var(--border-radius-card);
            box-shadow: var(--shadow-light);
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.3s ease;
            border: 1px solid rgba(0, 173, 181, 0.2);
            position: relative;
            overflow: hidden;
        }
        .section-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background-color: var(--accent-teal);
            border-top-left-radius: inherit;
            border-bottom-left-radius: inherit;
        }
        .section-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }
        .section-item .section-name {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.4em;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 5px;
            padding-left: 10px;
            text-align: left;
            flex-grow: 1;
        }
        .section-item .section-counts {
            font-size: 0.9em;
            color: var(--text-light);
            padding-left: 10px;
            text-align: left;
        }
        .section-item .section-counts span {
            font-weight: 600;
            color: var(--accent-teal);
        }
        .section-item .section-arrow {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5em;
            color: var(--accent-teal);
            transition: color 0.3s ease;
        }

        .content-category-header {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.6em;
            font-weight: 700;
            color: var(--highlight-gold);
            margin-top: 25px;
            margin-bottom: 15px;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .content-category-header i {
            font-size: 1.2em;
        }
        .content-list-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        #lessons-in-sections-view {
            display: none;
            padding: 0px;
        }
        #lessons-in-sections-view .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }
        #lessons-in-sections-view .back-button {
            background-color: transparent;
            border: none;
            font-size: 2em;
            color: var(--text-dark);
            cursor: pointer;
            margin-right: 18px;
            transition: color 0.2s ease, transform 0.2s ease;
        }
        #lessons-in-sections-view .back-button:hover {
            color: var(--accent-teal);
            transform: translateX(-5px);
        }
        #lessons-in-sections-view h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.2em;
            font-weight: 700;
            color: var(--text-dark);
            margin: 0;
            flex-grow: 1;
            transition: color 0.3s ease;
        }
        .lesson-list-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .lesson-list-item {
            background: linear-gradient(135deg, #2A2A2A, #222222);
            border-radius: var(--border-radius-card);
            box-shadow: var(--shadow-light);
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.3s ease;
            position: relative;
        }
        .lesson-list-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }
        .lesson-list-item-right {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            text-align: left;
        }
        .lesson-list-item .lesson-list-item-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.3em;
            font-weight: 700;
            color: var(--text-dark);
            margin: 0 0 5px 0;
            line-height: 1.2;
        }
        .lesson-list-item .video-icon-overlay {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2em;
            color: var(--error-red);
        }


        #video-player-view {
            display: none;
            padding: 0px;
            background-color: var(--player-bg-color);
            min-height: calc(100vh - 90px);
            transition: background-color 0.3s ease;
        }
        #video-player-view .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 0px;
            padding: 15px 20px;
            background-color: var(--player-bg-color);
            transition: background-color 0.3s ease;
        }
        #video-player-view .back-button {
            background-color: transparent;
            border: none;
            font-size: 2em;
            color: var(--text-dark);
            cursor: pointer;
            margin-right: 18px;
            transition: color 0.2s ease, transform 0.2s ease;
        }
        #video-player-view .back-button:hover {
            color: var(--accent-teal);
            transform: translateX(-5px);
        }
        #video-player-view h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.2em;
            font-weight: 700;
            color: var(--text-dark);
            margin: 0;
            flex-grow: 1;
            transition: color 0.3s ease;
        }

        .player-card-header-actions {
            display: flex;
            gap: 10px;
        }
        .player-card-header-actions .icon-button {
            font-size: 1.5em;
            color: var(--text-light);
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: color 0.2s ease, transform 0.2s ease, background-color 0.2s ease;
            position: relative;
        }
        .player-card-header-actions .like-button.liked {
            color: var(--error-red);
            transform: scale(1.1);
        }
        .player-card-header-actions .like-button:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }
        .like-count-display {
            position: absolute;
            top: 5px; /* Adjust as needed */
            right: 5px; /* Adjust as needed */
            background-color: var(--highlight-gold);
            color: var(--primary-dark);
            border-radius: 50%;
            padding: 3px 6px; /* Reduced padding */
            font-size: 0.6em;
            min-width: 20px;
            text-align: center;
            line-height: 1;
            transform: translate(50%, -50%);
        }
        @keyframes popAndPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }
        .like-button.animating {
            animation: popAndPulse 0.3s ease-out;
        }

        .player-card-container {
            padding: 0px 20px 20px 20px;
        }

        .player-card {
            background-color: var(--player-section-bg);
            border-radius: var(--border-radius-card);
            box-shadow: var(--shadow-light);
            overflow: hidden;
            border: 1px solid var(--border-color);
            margin-bottom: 20px;
            transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .main-video-player {
            position: relative;
            padding-top: 56.25%;
            background-color: #000;
            display: block;
        }
        .main-video-player iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        .player-metadata {
            padding: 20px;
            background-color: var(--player-meta-bg);
            border-top: 1px solid var(--border-color);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        .player-metadata .lesson-sub-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8em;
            font-weight: 600;
            color: var(--text-dark);
            margin-top: 0;
            margin-bottom: 10px;
            text-align: center;
            transition: color 0.3s ease;
        }
        
        .player-action-buttons {
            display: flex;
            gap: 8px; /* Reduced gap for smaller buttons */
            padding: 0 20px 20px 20px;
            flex-wrap: wrap; /* Allow buttons to wrap on smaller screens */
        }
        .player-action-buttons .action-button {
            flex: 1;
            min-width: 100px; /* Ensure buttons don't get too small */
            background-color: var(--button-primary);
            color: var(--white);
            border: none;
            border-radius: var(--border-radius-button);
            padding: 8px 10px; /* Smaller padding */
            font-family: 'Montserrat', sans-serif;
            font-size: 0.8em; /* Smaller font size */
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px; /* Smaller gap inside button */
            box-shadow: var(--shadow-light);
            transition: background-color 0.2s ease, transform 0.2s ease, color 0.3s ease;
        }
        .player-action-buttons .action-button:hover {
            transform: translateY(-2px);
        }
        .player-action-buttons .action-button.timeline {
            background-color: var(--timeline-btn-bg);
        }
        .player-action-buttons .action-button.comments {
            background-color: var(--comments-btn-bg);
        }
        .player-action-buttons .action-button.watch-later {
            background-color: var(--watch-later-btn-bg);
        }

        .lesson-list {
            list-style: none;
            padding: 0 20px;
            margin-top: 20px;
        }
        .lesson-item {
            background: linear-gradient(135deg, #2A2A2A, #222222);
            border-radius: var(--border-radius-card);
            box-shadow: var(--shadow-light);
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.3s ease;
            position: relative;
        }
        .lesson-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }
        .lesson-item h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.3em;
            color: var(--text-dark);
            margin-top: 0;
            margin-bottom: 0;
            transition: color 0.3s ease;
        }

        /* --- Bottom Navigation Bar --- */
        .bottom-navbar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #1A1A1A;
            box-shadow: 0 -6px 20px rgba(0, 0, 0, 0.3);
            display: flex;
            justify-content: space-around;
            padding: 15px 0;
            border-top-left-radius: var(--border-radius-main);
            border-top-right-radius: var(--border-radius-main);
            z-index: 1000;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }
        .nav-item {
            text-align: center;
            color: var(--text-light);
            font-size: 0.9em;
            text-decoration: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px;
            transition: color 0.2s ease, transform 0.2s ease;
        }
        .nav-item i {
            font-size: 1.8em;
            margin-bottom: 8px;
            transition: color 0.2s ease;
        }
        .nav-item.active {
            color: var(--accent-teal);
            font-weight: 700;
        }
        .nav-item.active i {
            color: var(--accent-teal);
        }
        .nav-item:hover {
            color: var(--accent-teal);
        }
        .nav-item:active {
            transform: scale(0.95);
        }

        /* --- Popup Styles --- */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .name-popup {
            background-color: #222222;
            padding: 40px;
            border-radius: var(--border-radius-main);
            box-shadow: var(--shadow-popup);
            text-align: center;
            width: 90%;
            max-width: 420px;
            position: relative;
            color: #333;
            transform: translateY(20px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .popup-overlay.active .name-popup {
            transform: translateY(0);
            opacity: 1;
        }

        .name-popup h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2em;
            color: var(--text-dark);
            margin-bottom: 25px;
            font-weight: 700;
            transition: color 0.3s ease;
        }

        .name-popup p {
            font-size: 1.1em;
            color: var(--text-light);
            margin-bottom: 30px;
            transition: color 0.3s ease;
        }

        .name-popup .input-container {
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-input);
            padding: 12px 18px;
            margin-bottom: 25px;
            position: relative;
            background-color: #383838;
            transition: border-color 0.2s ease, background-color 0.3s ease;
        }

        .name-popup .input-container:focus-within {
            border-color: var(--accent-teal);
        }

        .name-popup input[type="text"] {
            width: 100%;
            padding: 10px 0;
            padding-top: 20px;
            border: none;
            background: transparent;
            font-family: 'Open Sans', sans-serif;
            font-size: 1.2em;
            color: var(--text-dark);
            outline: none;
            transition: color 0.3s ease;
        }

         .name-popup input[type="text"]:focus + label,
         .name-popup input[type="text"]:not(:placeholder-shown) + label {
            top: 5px;
            font-size: 0.7em;
            color: var(--accent-teal);
        }

        .name-popup .char-count {
            font-size: 0.85em;
            color: var(--text-light);
            text-align: right;
            margin-top: -15px;
            margin-bottom: 25px;
            transition: color 0.3s ease;
        }

        .name-popup .role-selection {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            font-family: 'Open Sans', sans-serif;
        }

        .name-popup .role-option {
            display: flex;
            align-items: center;
            background-color: #444;
            padding: 8px 15px;
            border-radius: var(--border-radius-button);
            cursor: pointer;
            transition: background-color 0.2s ease, color 0.3s ease;
            font-size: 0.9em;
            color: var(--text-light);
        }

        .name-popup .role-option:hover {
            background-color: #555;
        }

        .name-popup input[type="radio"] {
            margin-right: 8px;
            accent-color: var(--accent-teal);
        }

        .name-popup button {
            background-color: var(--accent-teal);
            color: white;
            padding: 15px 35px;
            border: none;
            border-radius: var(--border-radius-button);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease, color 0.3s ease;
            box-shadow: var(--shadow-light);
        }

        .name-popup button:hover {
            background-color: #00939b;
            transform: translateY(-3px);
        }

        .popup-close-button {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 2em;
            color: var(--text-light);
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .popup-close-button:hover {
            color: var(--text-dark);
        }

        .comments-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .comments-popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .comments-popup {
            background-color: #222222;
            padding: 25px;
            border-radius: var(--border-radius-main);
            box-shadow: var(--shadow-popup);
            width: 90%;
            max-width: 500px;
            position: relative;
            color: #333;
            transform: translateY(20px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .comments-popup-overlay.active .comments-popup {
            transform: translateY(0);
            opacity: 1;
        }

        .comments-popup h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8em;
            color: var(--text-dark);
            margin-top: 0;
            margin-bottom: 20px;
            text-align: center;
            transition: color 0.3s ease;
        }

        .comments-input-area {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }

        .comments-input-area textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-input);
            font-family: 'Open Sans', sans-serif;
            font-size: 1em;
            min-height: 80px;
            resize: vertical;
            outline: none;
            transition: border-color 0.2s ease, background-color 0.3s ease, color 0.3s ease;
            background-color: #383838;
            color: var(--text-dark);
        }

        .comments-input-area button {
            background-color: var(--comments-btn-bg);
            color: var(--white);
            border: none;
            border-radius: var(--border-radius-button);
            padding: 10px 15px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.2s ease, color 0.3s ease;
        }

        .comments-input-area button:hover {
            background-color: #0056b3;
        }

        .comments-display-area {
            flex-grow: 1;
            overflow-y: auto;
            padding-right: 10px;
            margin-bottom: 10px;
        }

        .comment-item {
            background-color: #383838;
            border-radius: var(--border-radius-input);
            padding: 10px;
            margin-bottom: 10px;
            font-size: 0.9em;
            border: 1px solid #555;
            color: var(--text-dark);
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }

        .comment-item strong {
            color: var(--primary-dark);
            margin-right: 5px;
            transition: color 0.3s ease;
        }

        .no-comments-message {
            text-align: center;
            color: var(--text-light);
            font-style: italic;
            transition: color 0.3s ease;
        }
        /* NEW: Copyright Popup Styles */
        .copyright-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .copyright-popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .copyright-popup {
            background-color: var(--primary-dark);
            padding: 30px;
            border-radius: var(--border-radius-main);
            box-shadow: var(--shadow-popup);
            text-align: center;
            width: 90%;
            max-width: 450px;
            position: relative;
            color: var(--text-dark);
            transform: translateY(20px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
            border: 1px solid var(--accent-teal);
        }

        .copyright-popup-overlay.active .copyright-popup {
            transform: translateY(0);
            opacity: 1;
        }

        .copyright-popup h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8em;
            color: var(--highlight-gold);
            margin-bottom: 20px;
            font-weight: 700;
        }

        .copyright-popup p {
            font-size: 1.1em;
            color: var(--text-light);
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .copyright-popup .crazy-text {
            font-family: 'Comfortaa', sans-serif;
            font-size: 1.3em;
            font-weight: 800;
            color: var(--accent-teal);
            margin-top: 20px;
            animation: pulse 1.5s infinite alternate;
        }
        /* END NEW COPYRIGHT POPUP */


        .coming-soon-section {
            display: none;
            text-align: center;
            padding: 50px 20px;
            background-color: #333333;
            border-radius: var(--border-radius-main);
            box-shadow: var(--shadow-medium);
            margin-top: 30px;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 300px;
            border: 1px solid var(--border-color);
            color: var(--text-dark);
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .coming-soon-section h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.5em;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 20px;
            transition: color 0.3s ease;
        }

        .coming-soon-section p {
            font-size: 1.3em;
            color: var(--text-light);
            margin-bottom: 30px;
            line-height: 1.5;
            transition: color 0.3s ease;
        }

        .coming-soon-section .emoji {
            font-size: 3em;
            margin-top: 20px;
            animation: bounce 1s infinite alternate;
        }

        @keyframes bounce {
            0% { transform: translateY(0); }
            100% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.08); }
            100% { transform: scale(1); }
        }

        @keyframes fadeInSlideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        body.animate-in {
            animation: fadeInSlideUp 0.8s ease-out forwards;
        }

        @keyframes popupEnter {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(50px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        .popup-overlay.active .name-popup {
            animation: popupEnter 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        /* NEW: Notifications Popup Styles (Adjusted for longer UI) */
        .notifications-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            display: none; /* Hidden by default */
            justify-content: center; /* Changed from flex-end to center */
            align-items: flex-start; /* Align to top */
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .notifications-popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .notifications-popup {
            background-color: rgba(26, 43, 60, 0.95); /* Primary dark with transparency */
            padding: 20px;
            border-radius: var(--border-radius-main);
            box-shadow: var(--shadow-popup);
            width: 90%;
            max-width: 500px; /* Increased max-width for a longer look, adjust as needed */
            position: relative;
            color: var(--text-dark);
            transform-origin: top center; /* Changed from top right to top center */
            transform: scale(0.8) translateY(-20px); /* Adjust initial position for center alignment */
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
            display: flex;
            flex-direction: column;
            max-height: 80%; /* Limit height for scrollability */
            margin-top: 15px; /* Margin from top edge */
            /* margin-right: 15px; */ /* REMOVED this line or set to 0 */
            border: 1px solid var(--border-color); /* Subtle border */
        }

        .notifications-popup-overlay.active .notifications-popup {
            transform: scale(1) translateY(0%); /* Final state */
            opacity: 1;
            animation: notificationsPopupEnter 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; /* Re-added animation */
        }

        /* NEW: Notification Popup Animation (redefined for top-center origin) */
        @keyframes notificationsPopupEnter {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(-20px); /* Start scaled down and slightly up */
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0%); /* End at full size, no offset */
            }
        }
        
        /* New animations for homepage banner */
        @keyframes slideIn {
            0% {
                opacity: 0;
                transform: translateX(-50%) translateY(-50px);
                visibility: hidden;
            }
            100% {
                opacity: 1;
                transform: translateX(-50%) translateY(0px);
                visibility: visible;
            }
        }

        @keyframes fadeOut {
            0% {
                opacity: 1;
            }
            100% {
                opacity: 0;
            }
        }


        .hidden-on-scroll {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }

        .visible-on-scroll {
            opacity: 1;
            transform: translateY(0);
        }

        .offline-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 3000;
            color: white;
            font-size: 1.5em;
            text-align: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .offline-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .offline-overlay i {
            font-size: 3em;
            margin-bottom: 20px;
            color: #FFC107;
        }

        .offline-overlay p {
            margin: 0;
            padding: 0 20px;
        }

        .offline-overlay .reload-button {
            background-color: var(--accent-teal);
            color: var(--white);
            border: none;
            border-radius: var(--border-radius-button);
            padding: 10px 20px;
            margin-top: 20px;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            transition: background-color 0.2s ease;
        }

        .offline-overlay .reload-button:hover {
            background-color: #00939b;
        }

        #about-me-view {
            display: none;
            flex-direction: column;
            padding: 20px;
            min-height: calc(100vh - 90px);
            background-color: var(--secondary-light);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        #about-me-view .section-header {
            display: flex;
            align-items: center;
            width: 100%;
            margin-bottom: 25px;
        }

        #about-me-view .back-button {
            background-color: transparent;
            border: none;
            font-size: 2em;
            color: var(--text-dark);
            cursor: pointer;
            margin-right: 18px;
            transition: color 0.2s ease, transform 0.2s ease;
        }

        #about-me-view .back-button:hover {
            color: var(--accent-teal);
            transform: translateX(-5px);
        }

        #about-me-view h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.2em;
            font-weight: 700;
            color: var(--text-dark);
            margin: 0;
            flex-grow: 1;
            transition: color 0.3s ease;
        }

        .about-me-card {
            background-color: #333333;
            border-radius: var(--border-radius-main);
            box-shadow: var(--shadow-medium);
            padding: 30px;
            width: 100%;
            max-width: 500px;
            margin: 20px auto;
            border: 1px solid var(--border-color);
            transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .about-me-card .profile-pic {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 20px;
            border: 4px solid var(--accent-teal);
            box-shadow: 0 0 15px rgba(0,0,0,0.5);
        }

        .about-me-card h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8em;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 10px;
            transition: color 0.3s ease;
        }

        .about-me-card p {
            font-size: 1.1em;
            color: var(--text-light);
            margin-bottom: 25px;
            line-height: 1.6;
            transition: color 0.3s ease;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 20px;
        }

        .social-links a {
            font-size: 1.8em;
            color: var(--text-light);
            transition: color 0.2s ease, transform 0.2s ease;
        }
        
        .social-links a:hover {
            transform: translateY(-3px);
        }

        .social-link.telegram:hover { color: #0088cc; }

        .social-link.instagram:hover {
            background: radial-gradient(circle at 30% 107%, #fdf497 0%, #fdf497 5%, #fd5949 45%, #d6249f 60%, #285AEB 90%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .social-link.youtube:hover { color: #FF0000; }

        #how-to-use-app-view {
            display: none;
            flex-direction: column;
            padding: 20px;
            min-height: calc(100vh - 90px);
            background-color: var(--secondary-light);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        #how-to-use-app-view .section-header {
            display: flex;
            align-items: center;
            width: 100%;
            margin-bottom: 25px;
        }

        #how-to-use-app-view .back-button {
            background-color: transparent;
            border: none;
            font-size: 2em;
            color: var(--text-dark);
            cursor: pointer;
            margin-right: 18px;
            transition: color 0.2s ease, transform 0.2s ease;
        }

        #how-to-use-app-view .back-button:hover {
            color: var(--accent-teal);
            transform: translateX(-5px);
        }

        #how-to-use-app-view h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.2em;
            font-weight: 700;
            color: var(--text-dark);
            margin: 0;
            flex-grow: 1;
            transition: color 0.3s ease;
        }

        #how-to-use-app-view .video-container {
            position: relative;
            width: 100%;
            padding-top: 56.25%;
            background-color: #000;
            border-radius: var(--border-radius-card);
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: var(--shadow-medium);
        }

        #how-to-use-app-view .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        #how-to-use-app-view p {
            font-size: 1.1em;
            color: var(--text-light);
            line-height: 1.6;
            margin-top: 0;
            transition: color 0.3s ease;
        }
        
        .share-app-button {
            background-color: #007bff;
            color: var(--white);
            padding: 15px 25px;
            border-radius: var(--border-radius-button);
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease, color 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: var(--shadow-medium);
            margin-top: 30px;
            margin-bottom: 30px;
        }

        .share-app-button:hover {
            background-color: #0056b3;
            transform: translateY(-3px);
        }

        .share-app-button i {
            font-size: 1.5em;
        }

        .slider-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1500;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease;
        }

        .slider-menu-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .slider-menu {
            position: fixed;
            top: 0;
            left: -250px;
            width: 250px;
            height: 100%;
            background-color: var(--slider-bg);
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);
            z-index: 1600;
            transition: left 0.3s ease-in-out, background-color 0.3s ease;
            display: flex;
            flex-direction: column;
            padding-top: 20px;
            box-sizing: border-box;
            overflow-y: auto;
            padding-bottom: 20px;
        }

        .slider-menu.active {
            left: 0;
        }

        .slider-header {
            padding: 20px;
            display: flex;
            align-items: center;
            border-bottom: 1px solid var(--slider-border-color);
            margin-bottom: 10px;
            font-family: 'Comfortaa', sans-serif;
            transition: border-color 0.3s ease;
        }

        .slider-header img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-right: 15px;
            object-fit: cover;
            border: 2px solid var(--accent-teal);
            box-shadow: 0 0 8px rgba(0, 173, 181, 0.3);
        }

        .slider-header h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5em;
            font-weight: 700;
            color: var(--accent-teal);
            margin: 0;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
            transition: color 0.3s ease;
        }

        .slider-menu-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            color: var(--slider-text-color);
            text-decoration: none;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.05em;
            transition: background-color 0.2s ease, transform 0.2s ease, color 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .slider-menu-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 173, 181, 0.1), transparent);
            transition: left 0.3s ease-out;
        }

        .slider-menu-item:hover::before {
            left: 0;
        }

        .slider-menu-item:hover {
            background-color: var(--slider-item-hover);
            transform: translateX(5px);
        }

        .slider-menu-item i {
            font-size: 1.6em;
            margin-right: 15px;
            color: var(--slider-icon-color);
            transition: color 0.2s ease;
        }

        .slider-menu-item:hover i {
            color: var(--highlight-gold);
        }

        .slider-menu-item .item-text {
            flex-grow: 1;
            font-weight: 500;
        }

        .slider-menu-item .coming-soon-tag {
            background-color: #FFC107;
            color: #333;
            font-size: 0.7em;
            font-weight: 700;
            padding: 3px 8px;
            border-radius: 10px;
            margin-left: 10px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .slider-footer {
            margin-top: auto;
            padding: 15px 20px;
            text-align: center;
            border-top: 1px solid var(--slider-border-color);
            font-size: 0.85em;
            color: var(--text-light);
            font-family: 'Open Sans', sans-serif;
            line-height: 1.5;
            transition: border-color 0.3s ease, color 0.3s ease;
        }

        .slider-footer .version {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text-dark);
            font-size: 0.9em;
            transition: color 0.3s ease;
        }
        
        /* Dark Mode toggle styles are removed as per request */

        .notifications-popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .notifications-popup-header h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5em;
            font-weight: 700;
            color: var(--accent-teal);
            margin: 0;
        }

        .notifications-popup-header .mark-read-button {
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 0.9em;
            cursor: pointer;
            transition: color 0.2s ease;
        }
        .notifications-popup-header .mark-read-button:hover {
            color: var(--highlight-gold);
        }

        .notifications-popup .notifications-list {
            flex-grow: 1;
            overflow-y: auto;
            padding-right: 10px; /* For scrollbar spacing */
            -webkit-overflow-scrolling: touch;
        }

        .notifications-popup .notification-item {
            background-color: var(--secondary-light);
            padding: 15px;
            border-radius: var(--border-radius-card);
            margin-bottom: 10px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: background-color 0.2s ease, transform 0.2s ease;
        }

        .notifications-popup .notification-item:last-child {
            margin-bottom: 0;
        }

        .notifications-popup .notification-item.unread {
            background-color: rgba(0, 173, 181, 0.1); /* Slight highlight for unread */
            border-color: var(--accent-teal);
        }
        .notifications-popup .notification-item.unread:hover {
             background-color: rgba(0, 173, 181, 0.15);
        }
        .notifications-popup .notification-item.read {
            opacity: 0.8;
        }

        .notifications-popup .notification-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        .notifications-popup .notification-item-title {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 1.1em;
            color: var(--highlight-gold);
            margin-bottom: 5px;
        }

        .notifications-popup .notification-item-body {
            font-size: 0.95em;
            color: var(--text-light);
            line-height: 1.4;
            margin-bottom: 10px;
        }

        .notifications-popup .notification-item-time {
            font-size: 0.8em;
            color: var(--text-muted);
            text-align: right;
            margin-top: 5px;
        }

        .notifications-popup .notification-item-link {
            display: inline-block;
            background-color: var(--accent-teal);
            color: var(--white);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            text-decoration: none;
            margin-top: 10px;
            transition: background-color 0.2s ease;
        }
        .notifications-popup .notification-item-link:hover {
            background-color: #00939b;
        }

        .notifications-popup .no-notifications-message {
            text-align: center;
            color: var(--text-light);
            font-style: italic;
            padding: 20px;
        }

        /* Request Courses View Styles */
        #request-courses-view {
            display: none; /* Controlled by JS */
            padding: 0px;
        }
        #request-courses-view .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }
        #request-courses-view .back-button {
            background-color: transparent;
            border: none;
            font-size: 2em;
            color: var(--text-dark);
            cursor: pointer;
            margin-right: 18px;
            transition: color 0.2s ease, transform 0.2s ease;
        }
        #request-courses-view .back-button:hover {
            color: var(--accent-teal);
            transform: translateX(-5px);
        }
        #request-courses-view h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.2em;
            font-weight: 700;
            color: var(--text-dark);
            margin: 0;
            flex-grow: 1;
            transition: color 0.3s ease;
        }

        .request-posts-grid {
            display: grid;
            grid-template-columns: 1fr; /* Single column for mobile */
            gap: 20px;
            padding: 0px;
        }

        .request-post-card {
            background-color: var(--primary-dark); /* Darker background for contrast */
            border-radius: var(--border-radius-card);
            box-shadow: var(--shadow-light);
            overflow: hidden;
            border: 1px solid var(--border-color);
            transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.3s ease, border-color 0.3s ease;
            position: relative; /* For the new tag */
        }
        .request-post-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
            border-color: var(--accent-teal); /* Highlight on hover */
        }
        .request-post-card .post-image-container {
            width: 100%;
            height: 200px; /* Fixed height for images */
            overflow: hidden;
            background-color: #000; /* Black background if no image */
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer; /* Make image clickable for fullscreen */
        }
        .request-post-card .post-image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Cover the area, crop if needed */
        }
        .request-post-card .post-content {
            padding: 20px;
        }
        .request-post-card .post-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.4em;
            font-weight: 700;
            color: var(--highlight-gold); /* Gold for titles */
            margin-bottom: 10px;
        }
        .request-post-card .post-description {
            font-size: 0.95em;
            color: var(--text-light);
            margin-bottom: 15px;
            line-height: 1.5;
            text-align: justify;
        }
        .request-post-card .post-button {
            background-color: var(--accent-teal);
            color: var(--white);
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 15px;
            width: 100%; /* Make button full width */
        }
        .request-post-card .post-button:hover {
            background-color: #00939b;
            transform: translateY(-2px);
        }
        .request-post-card .post-reactions {
            display: flex;
            justify-content: space-around;
            gap: 10px;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
        }
        .request-post-card .reaction-icon-post {
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px 8px;
            border-radius: 5px;
            transition: background-color 0.2s ease;
            user-select: none;
            display: flex;
            align-items: center;
            color: var(--text-light);
        }
        .request-post-card .reaction-icon-post span {
            font-size: 0.8em;
            margin-left: 5px;
            color: var(--text-light);
        }
        .request-post-card .reaction-icon-post:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        .request-post-card .reaction-icon-post.reacted {
            background-color: rgba(0, 173, 181, 0.2);
            color: var(--accent-teal);
        }
        .request-post-card .reaction-emoji {
            font-size: 1.5em;
            line-height: 1;
        }
        .request-post-card .new-post-tag {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #FFC107; /* Orange/Gold */
            color: #333;
            font-size: 0.7em;
            font-weight: 700;
            padding: 4px 8px;
            border-radius: 5px;
            text-transform: uppercase;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 3;
        }

        /* Responsive adjustments for request posts */
        @media (min-width: 601px) {
            .request-posts-grid {
                grid-template-columns: repeat(2, 1fr); /* Two columns for larger screens */
            }
        }
        
        /* NEW: Homepage Batch Notification styles */
        .batch-notification-banner {
            position: fixed;
            top: 20px; /* Adjust as needed */
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--primary-dark); /* Dark background for the banner itself */
            color: var(--white);
            padding: 15px 25px; /* Increased padding */
            border-radius: var(--border-radius-card); /* Rounded corners like other cards */
            font-family: 'Montserrat', sans-serif;
            box-shadow: var(--shadow-medium);
            z-index: 1050; /* Above top-navbar but below fullscreen overlays */
            display: flex;
            flex-direction: column; /* Stack image and text vertically */
            align-items: center;
            gap: 10px;
            opacity: 0;
            visibility: hidden;
            /* animation: slideInFadeOut 5s forwards; */ /* This animation is now removed/managed by JS */
            width: 90%; /* Make it wider */
            max-width: 350px; /* Control max width for larger screens */
            border: 1px solid var(--accent-teal); /* A subtle border */
            cursor: pointer; /* Make banner clickable */
        }
        /* Notification image */
        .batch-notification-banner .notification-image {
            width: 60px; /* Size of the image */
            height: 60px;
            border-radius: 50%; /* Circular image */
            object-fit: cover;
            margin-bottom: 5px; /* Space between image and text */
            border: 2px solid var(--highlight-gold); /* Gold border for highlight */
            box-shadow: 0 0 8px rgba(255, 215, 0, 0.4); /* Glow effect */
        }
        .batch-notification-banner .notification-text-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            flex-grow: 1;
        }
        .batch-notification-banner .notification-title {
            font-weight: 700;
            font-size: 1.1em;
            color: var(--accent-teal);
            text-align: center;
        }
        .batch-notification-banner .notification-message-body {
            font-size: 0.9em;
            color: var(--text-light);
            text-align: center;
            line-height: 1.3;
        }
        .batch-notification-banner .notification-link-btn {
            background-color: #007bff;
            color: var(--white);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            text-decoration: none;
            margin-top: 8px;
            transition: background-color 0.2s ease;
        }
        .batch-notification-banner .notification-link-btn:hover {
            background-color: #0056b3;
        }

        /* NEW: Styles for Updated Batch Notification */
        .batch-notification-banner.updated {
            background-color: var(--highlight-gold); /* Gold background for updated */
            color: var(--primary-dark);
        }
        .batch-notification-banner.updated .notification-title {
            color: var(--primary-dark); /* Adjust title color for updated banner */
        }
        .batch-notification-banner.updated .notification-message-body {
            color: #444; /* Adjust body color for updated banner */
        }

        /* New animations for homepage banner */
        @keyframes slideIn {
            0% {
                opacity: 0;
                transform: translateX(-50%) translateY(-50px);
                visibility: hidden;
            }
            100% {
                opacity: 1;
                transform: translateX(-50%) translateY(0px);
                visibility: visible;
            }
        }

        @keyframes fadeOut {
            0% {
                opacity: 1;
            }
            100% {
                opacity: 0;
            }
        }
        /* Media query for smaller screens */
        @media (max-width: 400px) {
            .batch-notification-banner {
                padding: 10px 15px;
                max-width: 95%; /* Even wider on very small screens */
            }
            .batch-notification-banner .notification-image {
                width: 50px;
                height: 50px;
            }
            .batch-notification-banner .notification-title {
                font-size: 1em;
            }
            .batch-notification-banner .notification-message-body {
                font-size: 0.85em;
            }
        }

        /* Website Footer Styles */
        .website-footer {
            margin-top: 50px;
            padding: 20px;
            background-color: var(--primary-dark);
            color: var(--text-light);
            text-align: center;
            font-size: 0.9em;
            border-top: 1px solid var(--border-color);
        }
        .website-footer p {
            margin: 5px 0;
            line-height: 1.5;
        }
        .website-footer a {
            color: var(--accent-teal);
            text-decoration: none;
            font-weight: 600;
            transition: color 0.2s ease;
        }
        .website-footer a:hover {
            color: var(--highlight-gold);
        }

        /* NEW: Container for side-by-side buttons on desktop */
        .desktop-button-container {
            grid-column: 1 / -1; /* Ensure it spans the grid on mobile */
            margin-top: 20px;
            margin-bottom: 20px;
        }
        .desktop-button-container .share-app-button,
        .desktop-button-container .request-courses-button {
            margin: 10px 0;
        }

        /* --- MODIFIED & NEW: Desktop Responsiveness Enhancements --- */
        @media (max-width: 768px) {
            .top-navbar { padding: 12px 15px; }
            .top-navbar .app-logo .main-title { font-size: 1.3em; }
            .top-navbar .app-logo .tagline { font-size: 0.6em; }
            .top-navbar .app-logo img#skillNeastLogo { height: 30px; }
            .top-navbar .menu-icon, .top-navbar .telegram-icon, .top-navbar .notification-icon {
                width: 44px;
                height: 44px;
                font-size: 1.6em;
            }
            .top-navbar .notification-icon .badge {
                top: 2px;
                right: 2px;
                min-width: 18px;
                font-size: 0.6em;
            }
            .top-navbar .menu-icon { margin-right: 5px; }
            .top-navbar .telegram-icon { margin-left: 5px; }
            .top-navbar .app-logo {
                padding: 5px 10px;
                margin: 0 5px;
            }
            .welcome-banner { padding: 20px; }
            .welcome-banner .greeting { font-size: 1.4em; }
            .welcome-banner .fire-icon { font-size: 1.8em; }
            .quote-section { padding: 20px; }
            .quote-section .quote-text { font-size: 0.95em; }
            #home-view { gap: 15px; } /* Slightly reduce gap on mobile */
            .course-category-item { min-height: 160px; }
            .course-category-item .image-container img { padding: 5px; }
            .course-category-item .content-overlay { padding: 10px; }
            .course-category-item .category-name { font-size: 0.95em;}
        }

        @media (min-width: 768px) {
            /* Make batch lists into a grid on tablets and larger */
            #new-batches-view .batch-list,
            #favorites-view .batch-list {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
            }
            
            #new-batches-view .batch-card,
            #favorites-view .batch-card {
                margin-bottom: 0; /* Let gap handle spacing */
            }

            /* Make sections view a grid */
            #sections-view .sections-container {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
            }

            /* Improve category grid on tablets */
            #home-view #dynamic-categories-container {
                 grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (min-width: 992px) {
            /* Center homepage cards and give them a max-width so they don't stretch */
            #home-view .favorites-section-home-card,
            #home-view .surprise-button,
            #home-view .telegram-card,
            #home-view .desktop-button-container {
                max-width: 800px;
                margin-left: auto;
                margin-right: auto;
            }
            
            /* Style the button container for desktop */
            .desktop-button-container {
                display: flex;
                gap: 20px;
                align-items: center;
                justify-content: center;
            }

            /* Make buttons inside the container take equal width and remove their individual margins */
            .desktop-button-container > .share-app-button,
            .desktop-button-container > .request-courses-button {
                flex: 1; /* This makes them equal width */
                margin: 0;
            }
        }

        @media (min-width: 1200px) {
            /* Wider grids for large desktops */
            #new-batches-view .batch-list,
            #favorites-view .batch-list {
                grid-template-columns: repeat(3, 1fr);
            }
            #home-view #dynamic-categories-container {
                 grid-template-columns: repeat(4, 1fr);
            }
            #home-view .favorites-section-home-card,
            #home-view .surprise-button,
            #home-view .telegram-card,
            #home-view .desktop-button-container {
                max-width: 1000px; /* Allow a bit more width on very large screens */
            }
        }
    </style>
</head>
<body class="loading-active">
    
    <!-- Loading Screen Overlay - Visible by default -->
    <div class="loading-screen-overlay" id="loadingScreenOverlay">
        <!-- MODIFIED: Added a placeholder src for the logo -->
        <img src="https://i.postimg.cc/XYsJwG5q/Photo-Room-20250702-182637.png" alt="Logo" class="loading-logo" id="loadingScreenLogo" onerror="this.style.display='none';">
        <h1 class="loading-name" id="loadingScreenName">SKILLNEAST</h1>
        <div class="loading-progress-bar-container">
            <div class="loading-progress-bar"></div>
        </div>
        <p class="loading-tagline" id="loadingScreenTagline">NAVIGATION YOUR SKILL 🚀💡</p>
    </div>


    <div class="offline-overlay" id="offlineOverlay">
        <i class="fas fa-wifi"></i>
        <p>No Internet Connection 😕</p>
        <button class="reload-button" onclick="location.reload()">Retry 🔁</button>
    </div>

    <div class="fullscreen-image-overlay" id="fullscreenImageOverlay">
        <button class="fullscreen-image-close-button" onclick="window.closeFullscreenImage()">×</button>
        <img src="" alt="Full Screen Image" id="fullscreenImage">
    </div>

    <div class="global-notice-overlay" id="globalNoticeOverlay">
        <div class="global-notice-popup">
            <button class="global-notice-close-button" onclick="window.closeGlobalNoticePopup()">×</button>
            <div class="action-required-header">
                <i class="fas fa-exclamation-triangle"></i> ACTION REQUIRED!!! <i class="fas fa-exclamation-triangle"></i>
            </div>
            <p id="globalNoticeMessage"></p>
            <button class="join-button" id="globalNoticeJoinButton"></button>

            <div class="notice-reaction-container">
                <span class="reaction-icon-notice" data-reaction="❤️"><span class="reaction-emoji">❤️</span> <span class="count">0</span></span>
                <span class="reaction-icon-notice" data-reaction="😂"><span class="reaction-emoji">😂</span> <span class="count">0</span></span>
                <span class="reaction-icon-notice" data-reaction="👍"><span class="reaction-emoji">👍</span> <span class="count">0</span></span>
            </div>
        </div>
    </div>
    <div class="popup-overlay" id="namePopupOverlay">
        <div class="name-popup">
            <button class="popup-close-button" onclick="window.closeNamePopup()">×</button>
            <h2>Welcome to SkillNeast!</h2>
            <p>Please tell us your name and what you do to personalize your experience.</p>
            <div class="input-container">
                <label for="userNameInput" style="position: absolute; top: 12px; left: 18px; font-size: 0.9em; color: var(--text-light); transition: all 0.2s ease;">Enter Your Name</label>
                <input type="text" id="userNameInput" placeholder=" " maxlength="15" onkeyup="window.updateCharCount()">
            </div>
            <div class="char-count"><span id="currentCharCount">0</span>/15</div>
            <div class="role-selection">
                <label class="role-option"><input type="radio" name="userRole" value="Editor"> Editor ✂️</label>
                <label class="role-option"><input type="radio" name="userRole" value="Programmer"> Programmer 💻</label>
                <label class="role-option"><input type="radio" name="userRole" value="Content Creator"> Content Creator 🎬</label>
                <label class="role-option"><input type="radio" name="userRole" value="Music Artist"> Music Artist 🎶</label>
                <label class="role-option"><input type="radio" name="userRole" value="Other" checked> Other ✨</label>
            </div>
            <button onclick="window.submitName()">START LEARNING</button>
        </div>
    </div>

    <div class="comments-popup-overlay" id="commentsPopupOverlay" style="display: none;"> 
        <div class="comments-popup">
            <button class="popup-close-button" onclick="window.closeCommentsPopup()">×</button>
            <h2 id="commentsHeader">SR Comments</h2>
            <div class="comments-input-area">
                <textarea id="commentInput" placeholder="Write your comment here..."></textarea>
                <button onclick="window.postComment()">Post Comment</button>
            </div>
            <div class="comments-display-area" id="commentsDisplayArea">
                <p class="no-comments-message">No comments yet. Be the first to comment!</p>
            </div>
        </div>
    </div>

    <div class="notifications-popup-overlay" id="notificationsPopupOverlay">
        <div class="notifications-popup">
            <div class="notifications-popup-header">
                <h2>Notifications</h2>
                <button class="mark-read-button" onclick="window.markAllNotificationsAsRead()">Mark all as read</button>
                <button class="popup-close-button" onclick="window.closeNotificationsPopup()">×</button>
            </div>
            <div class="notifications-list" id="notificationsList">
                <p class="no-notifications-message">No new notifications.</p>
            </div>
        </div>
    </div>
    
    <div class="batch-notification-banner" id="homepageBatchNotification" style="display: none;">
        <img src="https://via.placeholder.com/60x60/00ADB5/ffffff?text=SN" alt="Batch Thumbnail" class="notification-image" id="batchNotificationImage">
        <div class="notification-text-content">
            <div class="notification-title" id="batchNotificationTitle"></div>
            <div class="notification-message-body" id="batchNotificationMessageBody"></div>
            <a href="#" class="notification-link-btn" id="batchNotificationLinkBtn" style="display: none;">View Batch</a>
        </div>
    </div>

    <div class="copyright-popup-overlay" id="copyrightPopupOverlay">
        <div class="copyright-popup">
            <button class="popup-close-button" onclick="window.closeCopyrightPopup()">×</button>
            <h2>SkillNeast - Our Mission 🌟</h2>
            <p>
                This website is built with a simple, yet powerful belief: <strong>Education is for Everyone!</strong> 🎓💡
                We strive to make quality learning accessible and enjoyable for all. No hidden costs, just pure knowledge!
            </p>
            <p class="crazy-text">
                Dive deep, learn crazy cool stuff, and unleash your inner genius! 🚀🧠
                Let's make every pixel a stepping stone to greatness! ✨🌌
            </p>
        </div>
    </div>
    <div class="top-navbar">
        <div class="menu-icon" id="menuIcon"><i class="fas fa-bars"></i></div>
        <div class="app-logo" id="appLogo">
            <img src="" alt="SkillNeast Logo" draggable="false" id="skillNeastLogo" onerror="this.onerror=null;this.src='https://via.placeholder.com/40x40/00ADB5/ffffff?text=SN';">
            <div class="text-wrapper">
                <span class="main-title">SKILLNEAST</span>
                <span class="tagline">Master New Skill 🚀💡</span>
            </div>
        </div>
        <div class="telegram-icon" onclick="window.open(window.siteConfig.telegramGroupLink || 'https://t.me/', '_blank');"><i class="fab fa-telegram-plane"></i></div>
        <div class="notification-icon" id="notificationIcon" onclick="window.openNotificationsPopup()">
            <i class="fas fa-bell"></i>
            <span class="badge" id="notificationBadge">0</span>
        </div>
    </div>

    <div class="main-content">

        <div class="welcome-banner">
            <span class="greeting"><i class="fas fa-heart"></i> Welcome <span id="displayedUserName">Guest</span></span>
            <span class="fire-icon"><i class="fas fa-fire"></i></span>
            <span class="role-sticker" id="displayedUserRole" style="display: none;"></span>
        </div>

        <div class="quote-section">
            <p class="quote-text" id="quoteText"></p>
            <p class="quote-author" id="quoteAuthor"></p>
        </div>

        <div class="telegram-channels-banner" id="telegramChannelsBanner">
            <div class="banner-title">
                <i class="fas fa-exclamation-triangle"></i> WE NEED <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h2 id="telegramBannerMainTitle">JOIN OUR OFFICIAL <br> TELEGRAM CHANNELS</h2>
            <div class="channel-list" id="telegramBannerChannelList">
            </div>
            <button class="click-here-button" id="telegramBannerButton">
                CLICK HERE!
                <i class="fas fa-arrow-right"></i>
            </button>
            <div class="your-support-text" id="telegramBannerSupportText">YOUR SUPPORT !!</div>
        </div>

        <div class="discover-notice" id="discoverNotice">
            <h4 class="text-center" id="discoverNoticeHeader">🙏 Namo Buddhaya Everyone 🙏</h4>
            <img src="" alt="Discover Notice Image" class="discover-image" id="discoverNoticeImage" style="display: none;"> <h4 id="discoverNoticeMainTitle">DISCOVER OUR APP\'S DELIGHTS!</h4>
            <ol id="discoverNoticePoints">
            </ol>
            <div class="discover-notice-reactions">
                <span class="reaction-icon-discover" data-reaction="❤️"><span class="reaction-emoji">❤️</span> <span class="count">0</span></span>
                <span class="reaction-icon-discover" data-reaction="😂"><span class="reaction-emoji">😂</span> <span class="count">0</span></span>
                <span class="reaction-icon-discover" data-reaction="👍"><span class="reaction-emoji">👍</span> <span class="count">0</span></span>
                <span class="reaction-icon-discover" data-reaction="🌟"><span class="reaction-emoji">🌟</span> <span class="count">0</span></span>
            </div>
        </div>

        <div id="home-view">
            <div id="dynamic-categories-container">
                <p class="text-center text-muted col-span-full" id="loadingCategoriesMessage">Loading categories...</p>
            </div>

            <div class="favorites-section-home-card" onclick="window.showFavoritesView()" id="favorites-section-home-card">
                <i class="fas fa-heart fav-icon"></i>
                <h2>My Favorite Batches</h2>
                <p>
                    <span style="font-weight: bold; color: var(--highlight-gold);">@skillneast_official @skillneast_updates</span><br>
                    Disclaimer: We believe learning is for everyone, always! Enjoy incredible insights and master skills with our amazing content—grab yours before it's too late! 🎉
                </p>
                <span class="fav-count" id="favorites-count">0 Batches</span>
            </div>
        
            <button class="surprise-button" onclick="window.openTodaySurpriseLink()">
                <i class="fas fa-gift"></i> Today's Surprise! 🎉
            </button>

            <div class="telegram-card" onclick="window.open(window.siteConfig.telegramGroupLink || 'https://t.me/', '_blank');">
                <i class="fab fa-telegram-plane telegram-icon-large"></i>
                <span class="telegram-text">Join Our Telegram Community!</span>
            </div>
            
            <!-- MODIFIED: Wrapper for side-by-side buttons on desktop -->
            <div class="desktop-button-container">
                <button class="share-app-button" onclick="window.shareApp()">
                    <i class="fas fa-share-alt"></i> Share with your Friends
                </button>
                
                <!-- MODIFIED: Changed class and removed inline styles -->
                <button class="request-courses-button" onclick="window.showRequestCoursesView()">
                    <i class="fas fa-hand-paper"></i> Request Courses 📌
                </button>
            </div>
        </div>

        <div id="new-batches-view" style="display: none;">
            <div class="section-header">
                <button class="back-button" onclick="window.showHomeView()"><i class="fas fa-arrow-left"></i></button>
                <h2 id="new-batches-title">All Courses</h2>
            </div>
        
            <div class="search-bar-container">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="batchSearchInput" placeholder="Search by batch name" onkeyup="window.filterBatches()">
                <button class="search-button" onclick="window.filterBatches()">Search</button>
            </div>
            <div class="batch-list" id="batches-container">
                <p class="text-center text-muted" id="loadingBatchesMessage">Loading batches...</p>
            </div>
        </div>

        <div id="favorites-view" style="display: none;">
            <div class="section-header">
                <button class="back-button" onclick="window.showHomeView()"><i class="fas fa-arrow-left"></i></button>
                <h2>Favourite Batches</h2>
            </div>
            <div class="batch-list" id="favorite-batches-container">
            </div>
            <p id="no-favorites-message-view" class="no-favorites-message-view" style="display: none;">You haven't favorited any batches yet. Click the heart icon on any batch to add it here!</p>
        </div>

        <div id="sections-view" style="display: none;">
            <div class="section-header">
                <button class="back-button" onclick="window.showNewBatchesView(window.lastCategoryViewed)"><i class="fas fa-arrow-left"></i></button>
                <h2 id="sections-title"></h2>
            </div>
            <div class="sections-container" id="sections-container">
            </div>
        </div>

        <div id="lessons-in-sections-view" style="display: none;">
            <div class="section-header">
                <button class="back-button" onclick="window.goBackFromLessonsList()"><i class="fas fa-arrow-left"></i></button>
                <h2 id="lessons-in-sections-title"></h2>
            </div>
            <div class="lesson-list-container" id="lessons-in-sections-container">
            </div>
        </div>

        <div id="video-player-view" style="display: none;">
            <div class="section-header">
                <button class="back-button" onclick="window.goBackFromPlayerView()"><i class="fas fa-arrow-left"></i></button>
                <h2 id="player-view-title"></h2>
                <div class="player-card-header-actions">
                    <button class="icon-button like-button" id="likeButton"><i class="fas fa-heart"></i><span class="like-count-display" id="likeCountDisplay">0</span></button>
                    <button class="icon-button" id="fullscreenButton" onclick="window.toggleFullScreen()"><i class="fas fa-expand"></i></button>
                </div>
            </div>
            <div class="player-card-container">
                <div class="player-card">
                    <div class="main-video-player" id="main-video-player">
                    </div>
                    <div class="player-metadata">
                        <h3 class="lesson-sub-title" id="player-lesson-sub-title"></h3>
                        <div class="quote-section" style="margin-top: 20px; margin-bottom: 0px;">
                            <p class="quote-text" id="playerQuoteText"></p>
                            <p class="quote-author" id="playerQuoteAuthor"></p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="player-action-buttons">
                <button class="action-button timeline" onclick="window.showComingSoonView('timeline')"><i class="fas fa-stream"></i> Timeline</button>
                <button class="action-button comments" onclick="window.showComingSoonView('comments-coming-soon')"><i class="fas fa-comments"></i> SR Comments</button>
                <button class="action-button watch-later" onclick="window.showComingSoonView('watch-later')"><i class="fas fa-bookmark"></i> Watch Later</button>
            </div>
            
            <ul class="lesson-list" id="lessons-for-player-batch">
            </ul>
        </div>

        <div id="timeline-coming-soon-view" class="coming-soon-section" style="display: none;">
            <div class="section-header">
                <button class="back-button" onclick="window.goBackFromPlayerView()"><i class="fas fa-arrow-left"></i></button>
                <h2>Timeline Coming Soon!</h2>
            </div>
            <i class="emoji">⏳</i>
            <p>We're building advanced timeline features to help you navigate lectures seamlessly. Stay tuned! 🚀</p>
        </div>
        <div id="watch-later-coming-soon-view" class="coming-soon-section" style="display: none;">
            <div class="section-header">
                <button class="back-button" onclick="window.goBackFromPlayerView()"><i class="fas fa-arrow-left"></i></button>
                <h2>Watch Later Coming Soon!</h2>
            </div>
            <i class="emoji">⏰</i>
            <p>Save lectures to watch later and organize your study schedule. This feature is in the works! ✨</p>
        </div>
        
        <div id="comments-coming-soon-view" class="coming-soon-section" style="display: none;">
            <div class="section-header">
                <button class="back-button" onclick="window.goBackFromPlayerView()"><i class="fas fa-arrow-left"></i></button>
                <h2>Comments Section Coming Soon!</h2>
            </div>
            <i class="emoji">💬</i>
            <p>We're working on an interactive comments feature to enhance your learning experience. Stay tuned! ✨</p>
        </div>

        <div id="bundles-coming-soon-view" class="coming-soon-section" style="display: none;">
            <div class="section-header">
                <button class="back-button" onclick="window.showHomeView()"><i class="fas fa-arrow-left"></i></button>
                <h2>Bundles Coming Soon!</h2>
            </div>
            <i class="emoji">🎁</i>
            <p>Exciting new course bundles are on their way. Stay tuned for amazing deals and curated learning paths!</p>
        </div>

        <div id="pdfs-coming-soon-view" class="coming-soon-section" style="display: none;">
            <div class="section-header">
                <button class="back-button" onclick="window.showHomeView()"><i class="fas fa-arrow-left"></i></button>
                <h2>PDFs Coming Soon!</h2>
            </div>
            <i class="emoji">📄</i>
            <p>We're preparing a comprehensive library of downloadable PDFs and study materials for you. Check back soon!</p>
        </div>

        <div id="ai-chatbot-coming-soon-view" class="coming-soon-section" style="display: none;">
            <div class="section-header">
                <button class="back-button" onclick="window.showHomeView()"><i class="fas fa-arrow-left"></i></button>
                <h2>Neast Bro (AI Chatbot) Coming Soon!</h2>
            </div>
            <i class="emoji">🤖</i>
            <p>Get ready for personalized assistance! Our AI Chatbot, Neast Bro, is under development to help you with your learning journey. Stay tuned for its launch! 🚀</p>
        </div>

        <div id="about-me-view" style="display: none;">
            <div class="section-header">
                <button class="back-button" onclick="window.showHomeView()"><i class="fas fa-arrow-left"></i></button>
                <h2>About Me</h2>
            </div>
            <div class="about-me-card">
                <img src="" alt="Fahad Profile" class="profile-pic" draggable="false" id="aboutMeProfilePic" onerror="this.onerror=null;this.src='https://via.placeholder.com/120x120/00ADB5/ffffff?text=Fahad';">
                <h3>Hello, I'm Fahad! 👋</h3>
                <p>I'm 16 years old and currently learning in Class 11 with PCM (Physics, Chemistry, Maths) stream. Skills abhi kuch nahi hain, but har roz kuch naya seekh raha hoon! Learning is my journey. 😊</p>
                <div class="social-links">
                    <a href="" target="_blank" class="social-link telegram" id="aboutMeTelegramGroupLink"><i class="fab fa-telegram-plane"></i></a>
                    <a href="" target="_blank" class="social-link instagram" id="aboutMeInstagramLink"><i class="fab fa-instagram"></i></a>
                    <a href="" target="_blank" class="social-link youtube" id="aboutMeYoutubeLink"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
        </div>

        <div id="how-to-use-app-view" style="display: none;">
            <div class="section-header">
                <button class="back-button" onclick="window.showHomeView()"><i class="fas fa-arrow-left"></i></button>
                <h2>How to use the App</h2>
            </div>
            <div class="video-container">
            </div>
            <p>
            </p>
            <p>If you have any further questions, feel free to reach out to us through the Telegram community link in the menu!</p>
        </div>

        <div id="request-courses-view" style="display: none;">
            <div class="section-header">
                <button class="back-button" onclick="window.showHomeView()"><i class="fas fa-arrow-left"></i></button>
                <h2>Community Requests <i class="fas fa-hand-paper"></i></h2>
            </div>
            <div id="request-posts-container" class="request-posts-grid">
                <p class="text-center text-muted col-span-full" id="loadingRequestPostsMessage">Loading community requests...</p>
            </div>
        </div>
    </div> 
  
    <div class="bottom-navbar">
        <a href="#" class="nav-item" id="courses-nav" onclick="window.showNewBatchesView('all'); window.highlightBottomNav('courses-nav')"><i class="fas fa-book-open"></i> Courses</a>
        <a href="#" class="nav-item" id="bundles-nav" onclick="window.showComingSoonView('bundles'); window.highlightBottomNav('bundles-nav');"><i class="fas fa-boxes"></i> Bundles</a>
        <a href="#" class="nav-item active" id="home-nav" onclick="window.showHomeView(); window.highlightBottomNav('home-nav')"><i class="fas fa-home"></i> Home</a>
        <a href="#" class="nav-item" id="pdfs-nav" onclick="window.showComingSoonView('pdfs'); window.highlightBottomNav('pdfs-nav');"><i class="fas fa-file-pdf"></i> PDFs</a>
        <a href="#" class="nav-item" id="about-me-nav" onclick="window.showAboutMeView(); window.highlightBottomNav('about-me-nav');"><i class="fas fa-user-circle"></i> About Me</a>
    </div>

    <div class="slider-menu-overlay" id="sliderMenuOverlay" onclick="window.closeSliderMenu()"></div>
    <div class="slider-menu" id="sliderMenu">
        <div class="slider-header">
            <img src="" alt="SkillNeast Logo" id="sliderHeaderLogo" onerror="this.onerror=null;this.src='https://via.placeholder.com/50x50/00ADB5/ffffff?text=SN';">
            <h3>SkillNeast</h3>
        </div>
        
        <a href="#" class="slider-menu-item" onclick="window.showComingSoonView('ai-chatbot'); window.closeSliderMenu();">
            <i class="fas fa-robot"></i> <span class="item-text">Neast Bro (AI Chatbot)</span> <span class="coming-soon-tag">Coming Soon</span>
        </a>
        <a href="#" class="slider-menu-item" onclick="window.showAboutMeView(); window.closeSliderMenu();">
            <i class="fas fa-user-circle"></i> <span class="item-text">About Me</span>
        </a>
        <a href="#" class="slider-menu-item" onclick="window.showFavoritesView(); window.closeSliderMenu();">
            <i class="fas fa-heart"></i> <span class="item-text">Favorite Batches</span>
        </a>
        <a href="" target="_blank" class="slider-menu-item" id="sliderTelegramChannelLink">
            <i class="fab fa-telegram-plane"></i> <span class="item-text">Join Telegram Channel</span>
        </a>
        <a href="" target="_blank" class="slider-menu-item" id="sliderTelegramGroupLink">
            <i class="fab fa-telegram-plane"></i> <span class="item-text">Join Telegram Group</span>
        </a>
        <a href="#" class="slider-menu-item" id="sliderRequestCoursesLink" onclick="window.showRequestCoursesView(); window.closeSliderMenu();">
            <i class="fas fa-hand-paper"></i> <span class="item-text">Request Courses</span>
        </a>
        <a href="#" class="slider-menu-item" onclick="window.showHowToUseAppView(); window.closeSliderMenu();">
            <i class="fas fa-question-circle"></i> <span class="item-text">How to use the App</span>
        </a>
        <a href="#" class="slider-menu-item" onclick="window.shareApp(); window.closeSliderMenu();">
            <i class="fas fa-share-alt"></i> <span class="item-text">Share with your Friends</span>
        </a>
        <a href="#" class="slider-menu-item" onclick="window.showCopyrightPopup(); window.closeSliderMenu();">
            <i class="fas fa-copyright"></i> <span class="item-text">Copyright Info</span>
        </a>
        <div class="slider-footer">
            <div class="version">App Version: v1.0.0 (G.O.A.T)</div>
            Made with ❤️ in INDIA 🇮🇳
        </div>
    </div>

    <div class="website-footer">
        <p>© 2025 SkillNeast. All rights reserved.</p>
        <p><a href="#" onclick="event.preventDefault(); window.showCopyrightPopup();">Copyright ©️</a></p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
        import { getDatabase, ref as dbRef, push, set, update, remove, onValue, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
        import { getFirestore, collection, query, where, addDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";
        const firebaseConfig = {
          apiKey: "AIzaSyChwpbFb6M4HtG6zwjg0AXh7Lz9KjnrGZk",
          authDomain: "adminneast.firebaseapp.com",
          databaseURL: "https://adminneast-default-rtdb.firebaseio.com",
          projectId: "adminneast",
          storageBucket: "adminneast.appspot.com", 
          messagingSenderId: "883877553418",
          appId: "1:883877553418:web:84ce8200f4b471bfffc6f3",
          measurementId: "G-PCH99BDF1S"
        };
        const app = initializeApp(firebaseConfig);
        const rtdb = getDatabase(app);
        const auth = getAuth(app);
        const firestore = getFirestore(app);

        let isAuthenticated = false;
        let currentUserId = null;
        window.userLikes = JSON.parse(localStorage.getItem('userLikes')) || [];
        window.userNoticeReactions = JSON.parse(localStorage.getItem('userNoticeReactions')) || {};
        window.userDiscoverNoticeReactions = JSON.parse(localStorage.getItem('userDiscoverNoticeReactions')) || {};
        window.userRequestReactions = JSON.parse(localStorage.getItem('userRequestReactions')) || {}; 
        window.userNotifications = JSON.parse(localStorage.getItem('userNotifications')) || {};
        // Store individual notification read status
        let allNotifications = JSON.parse(localStorage.getItem('allNotifications')) || {};
        // Store all notifications, including welcome
        const likesRef = dbRef(rtdb, 'likes');
        const globalNoticeRef = dbRef(rtdb, 'notices/globalNotice');
        const discoverNoticeReactionsRef = dbRef(rtdb, 'notices/discoverNoticeReactions');
        const requestCoursesRef = dbRef(rtdb, 'requestCourses'); 
        const notificationsRef = dbRef(rtdb, 'notifications');
        // Firebase ref for notifications
        const homepageBatchNotificationsRef = dbRef(rtdb, 'homepageBatchNotifications');
        // NEW: Ref for batch notifications (This reference is not used for updated batch notification)
        const websiteStatsRef = dbRef(rtdb, 'websiteStats');

        // NEW: Function to update active user count
        const updateActiveUser = async () => {
            if (!currentUserId) return;
            const userActivityRef = dbRef(rtdb, `websiteStats/activeUsers/${currentUserId}`);
            
            // Set presence and automatically remove on disconnect
            await set(userActivityRef, {
                lastActive: serverTimestamp(),
                // You can add more user info here if needed, e.g., browser, device
            });
            // Keep alive every X seconds
            setInterval(() => {
                set(userActivityRef, { lastActive: serverTimestamp() });
            }, 30 * 1000);

            // Increment total visits only once per session
            if (!sessionStorage.getItem('visited_this_session')) {
                const totalVisitsRef = dbRef(rtdb, 'websiteStats/totalVisits');
                // Use a transaction or Cloud Functions for atomic increments in production
                // For simplicity, directly read and write, but be aware of race conditions
                onValue(totalVisitsRef, (snapshot) => {
                    let currentVisits = snapshot.val() || 0;
                    set(totalVisitsRef, currentVisits + 1);
                }, { onlyOnce: true });
                sessionStorage.setItem('visited_this_session', 'true');
            }
        };
        // Helper function for atomic increment (since Firebase JS SDK 9.x doesn't directly expose increment)
        function increment(value) {
            return {
                ".sv": {
                    "increment": value
                }
            };
        }


        window.siteConfig = {
            telegramChannelLink: 'https://t.me/default_channel',
            telegramGroupLink: 'https://t.me/default_group',
            youtubeLink: 'https://youtube.com/default_channel',
            instagramLink: 'https://instagram.com/default_profile',
            requestCoursesLink: '#',
            profilePictureUrl: 'https://via.placeholder.com/120x120/00ADB5/ffffff?text=Fahad',
            skillNeastLogoUrl: 'https://via.placeholder.com/40x40/00ADB5/ffffff?text=SN',
            sliderHeaderPictureUrl: 'https://via.placeholder.com/50x50/00ADB5/ffffff?text=SN',
            pwLogoUrl: 'https://via.placeholder.com/50x50/000000/ffffff?text=PW',
            surpriseButtonLink: '#',
            telegramBannerVisible: true, 
            telegramBannerTitle: 'JOIN OUR OFFICIAL <br> TELEGRAM CHANNELS',
            telegramBannerChannelList: '• Study Ratna ✨|• RATNA Official 📣|• Anime Speaks 🐉|• Code with RATNA 💻',
            telegramBannerButtonText: 'CLICK HERE!',
            telegramBannerButtonLink: 'https://t.me/default_group',
            telegramBannerSupportText: 'YOUR SUPPORT !!',
            
            discoverNoticeVisible: true, 
            discoverNoticeHeaderEmoji: '🙏',
            discoverNoticeTitle: 'DISCOVER OUR APP\'S DELIGHTS!',
            discoverNoticePoints: '🚫 Don\'t buy this App from AnyOne. This App is Free 🆓 of Cost for EveryOne. Unfortunately, If you Purchased this App, then please report! that user who sold you this App and take your Money Back.|🤝 Join Us on Telegram : Scam se bachne ke liye, Get updates, mentorship, and connect with us.',
            discoverNoticeImageUrl: '',
            // NEW: Loading Screen Defaults
            loadingScreenEnabled: true,
            loadingScreenLogoUrl: 'https://i.postimg.cc/XYsJwG5q/Photo-Room-20250702-182637.png',
            loadingScreenName: 'SKILLNEAST',
            loadingScreenTagline: 'NAVIGATION YOUR SKILL'
        };
        window.openTodaySurpriseLink = () => {
            alert('Loading surprise link... Please wait.');
        };
        const authenticateFirebase = async () => {
            try {
                if (typeof __initial_auth_token !== 'undefined') {
                    const userCredential = await signInWithCustomToken(auth, __initial_auth_token);
                    currentUserId = userCredential.user.uid;
                    isAuthenticated = true;
                    console.log("Public site: Signed in with custom token. UID:", currentUserId);
                } else {
                    const userCredential = await signInAnonymously(auth);
                    currentUserId = userCredential.user.uid;
                    isAuthenticated = true;
                    console.log("Public site: Signed in anonymously. UID:", currentUserId);
                }
                updateActiveUser();
            } catch (error) {
                console.error("Public site Firebase authentication error:", error);
                alert("Firebase Authentication Error: " + error.message);
            }
        };
        const quotes = [
            { quote: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
            { quote: "Success is not final, failure is not fatal: It is the courage to continue that counts.", author: "Winston Churchill" },
            { quote: "Believe you can and you're halfway there.", author: "Theodore Roosevelt" },
            { quote: "The mind is everything. What you think you become.", author: "Buddha" },
            { quote: "The best way to predict the future is to create it.", author: "Peter Drucker" }
        ];
        const allEmojis = ['✨', '🚀', '💡', '🌟', '💪', '🔥', '💖', '🎓', '📚', '🎯'];
        let availableQuoteIndices = [];
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        let allCategoriesData = {};
        window.favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        let currentView = 'home-view';
        let currentBatchId = null;
        let currentSectionIndex = null;
        window.currentPlayingLectureId = null;
        window.lastCategoryViewed = 'all';
        // Store dismissed notifications. Key is batchId, value is timestamp of when it was dismissed.
        const batchNotificationDismissedState = JSON.parse(localStorage.getItem('batchNotificationDismissedState')) || {}; 

        function extractVideoId(url) {
            let videoId = null;
            let videoType = null;

            // Try YouTube
            const youtubeMatch = url.match(/(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=|embed\/|v\/|)([\w-]{11})(?:\S+)?/);
            if (youtubeMatch && youtubeMatch[1]) {
                videoId = youtubeMatch[1];
                videoType = 'youtube';
            }

            // Try Google Drive - more robust regex
            const gdriveMatch = url.match(/(?:drive\.google\.com\/(?:file\/d\/|open\?id=|embed\/|a\/[^/]+\/file\/d\/|a\/[^/]+\/open\?id=))([a-zA-Z0-9_-]+)/);
            if (!videoId && gdriveMatch && gdriveMatch[1]) { 
                videoId = gdriveMatch[1];
                videoType = 'gdrive';
            }
            
            if (videoId && videoType) {
                return { type: videoType, id: videoId };
            }
            return null;
        }

        function getFileExtension(url, name) {
            if (name) {
                const nameParts = name.split('.');
                if (nameParts.length > 1) {
                    return nameParts.pop();
                }
            }
            if (url) {
                const urlParts = url.split('.');
                if (urlParts.length > 1) {
                    return urlParts.pop().split('?')[0].split('#')[0];
                }
                if (url.includes('youtube.com') || url.includes('youtu.be')) {
                    return 'youtube';
                }
                if (url.includes('drive.google.com')) {
                    return 'gdrive';
                }
            }
            return '';
        }

        window.openSliderMenu = function() {
            document.getElementById('sliderMenu').classList.add('active');
            document.getElementById('sliderMenuOverlay').classList.add('active');
        };

        window.closeSliderMenu = function() {
            document.getElementById('sliderMenu').classList.remove('active');
            document.getElementById('sliderMenuOverlay').classList.remove('active');
        };
        document.addEventListener('DOMContentLoaded', async () => {
            document.getElementById('menuIcon').addEventListener('click', window.openSliderMenu);

            await authenticateFirebase();
            loadAllCategoriesFromFirebase();
            loadSiteConfigAndApply(); // This will now handle the loading screen
            listenForNewNotifications(); 
            listenForHomepageBatchNotifications(); 

            let userName = localStorage.getItem('userName');
            let userRole = localStorage.getItem('userRole');
            const popupOverlay = document.getElementById('namePopupOverlay');
            document.body.classList.add('animate-in'); 

            if (!userName || !userRole) {
                popupOverlay.classList.add('active');
                document.querySelector('input[name="userRole"][value="Other"]').checked = true;
            } else {
                updateWelcomeSection();
            }

            for (let i = 0; i < quotes.length; i++) {
                availableQuoteIndices.push(i);
            }
            shuffleArray(availableQuoteIndices);

            window.highlightBottomNav('home-nav');
            renderFavoritesSectionHomeCard();
            window.updateQuote();
            setInterval(window.updateQuote, 6 * 60 * 60 * 1000); // Update quote every 6 hours globally

            document.addEventListener('contextmenu', (e) => { e.preventDefault(); });
            function updateOnlineStatus() {
                const offlineOverlay = document.getElementById('offlineOverlay');
                if (navigator.onLine) {
                    offlineOverlay.classList.remove('active');
                } else {
                    offlineOverlay.classList.add('active');
                }
            }

            window.addEventListener('online', updateOnlineStatus);
            window.addEventListener('offline', updateOnlineStatus);
            updateOnlineStatus();

            const appLogo = document.getElementById('appLogo');
            const skillNeastLogoImage = document.getElementById('skillNeastLogo');
            appLogo.addEventListener('click', () => {
                if (!skillNeastLogoImage.classList.contains('rotating')) {
                    skillNeastLogoImage.classList.add('rotating');
                    setTimeout(() => {
                        skillNeastLogoImage.classList.remove('rotating');
                        location.reload();
                    }, 1000);
                }
            });
            loadHowToUseVideosForWebsite();
            setupLikeButton();

            openGlobalNoticePopup();
            updateNotificationBadge(); // Initial badge update
        });
        // Modified updateQuote to safely update player elements
        window.updateQuote = function() {
            const quoteTextElement = document.getElementById('quoteText');
            const quoteAuthorElement = document.getElementById('quoteAuthor');
            
            if (availableQuoteIndices.length === 0) {
                for (let i = 0; i < quotes.length; i++) availableQuoteIndices.push(i);
                shuffleArray(availableQuoteIndices);
            }

            const quoteIndex = availableQuoteIndices.pop();
            const selectedQuote = quotes[quoteIndex];
            const randomEmoji = allEmojis[Math.floor(Math.random() * allEmojis.length)];
            // Safely update homepage quote elements
            if (quoteTextElement) {
                quoteTextElement.innerHTML = `"${selectedQuote.quote}" <span class="quote-emoji">${randomEmoji}</span>`;
            }
            if (quoteAuthorElement) {
                quoteAuthorElement.textContent = `- ${selectedQuote.author}`;
            }

            // Update player quote section if the player view is active
            const playerQuoteTextElement = document.getElementById('playerQuoteText');
            const playerQuoteAuthorElement = document.getElementById('playerQuoteAuthor');
            if (playerQuoteTextElement && playerQuoteAuthorElement) { // Check if elements exist before updating
                playerQuoteTextElement.innerHTML = `"${selectedQuote.quote}" <span class="quote-emoji">${randomEmoji}</span>`;
                playerQuoteAuthorElement.textContent = `- ${selectedQuote.author}`;
            }
        }

        window.updateCharCount = function() {
            const userNameInput = document.getElementById('userNameInput');
            const currentCharCount = document.getElementById('currentCharCount');
            if (userNameInput && currentCharCount) {
                 currentCharCount.textContent = userNameInput.value.length;
            }
        }

        window.submitName = function() {
            let userName = document.getElementById('userNameInput').value.trim();
            let userRole = document.querySelector('input[name="userRole"]:checked')?.value; // Use optional chaining

            if (userName === '') userName = 'Guest';
            localStorage.setItem('userName', userName.substring(0, 15));
            localStorage.setItem('userRole', userRole || 'Other'); // Default to 'Other' if not selected

            updateWelcomeSection();
            window.closeNamePopup();
        }

        function updateWelcomeSection() {
            const userName = localStorage.getItem('userName') || 'Guest';
            const userRole = localStorage.getItem('userRole') || '';
            const displayedUserNameElement = document.getElementById('displayedUserName');
            const displayedUserRoleElement = document.getElementById('displayedUserRole');
            if (displayedUserNameElement) {
                displayedUserNameElement.textContent = userName;
            }
            if (displayedUserRoleElement) {
                if (userRole && userRole !== 'Other') {
                    displayedUserRoleElement.textContent = userRole;
                    displayedUserRoleElement.style.display = 'inline-block';
                } else {
                    displayedUserRoleElement.style.display = 'none';
                }
            }
        }

        window.closeNamePopup = () => document.getElementById('namePopupOverlay').classList.remove('active');
        function hideAllViews() {
            const views = [
                'home-view', 'new-batches-view', 'favorites-view', 'sections-view', 
                'lessons-in-sections-view', 'video-player-view', 'bundles-coming-soon-view', 
                'pdfs-coming-soon-view', 'about-me-view', 'how-to-use-app-view', 
                'ai-chatbot-coming-soon-view', 'timeline-coming-soon-view', 'watch-later-coming-soon-view',
                'comments-coming-soon-view',
                'request-courses-view' 
            ];
            const commentsPopupOverlay = document.getElementById('commentsPopupOverlay');
            if (commentsPopupOverlay) {
                commentsPopupOverlay.classList.remove('active');
                commentsPopupOverlay.style.display = 'none';
            }
            // Hide notifications popup
            const notificationsPopupOverlay = document.getElementById('notificationsPopupOverlay');
            if (notificationsPopupOverlay) {
                notificationsPopupOverlay.classList.remove('active');
                notificationsPopupOverlay.style.display = 'none';
            }
            // Hide copyright popup
            const copyrightPopupOverlay = document.getElementById('copyrightPopupOverlay');
            if (copyrightPopupOverlay) {
                copyrightPopupOverlay.classList.remove('active');
                copyrightPopupOverlay.style.display = 'none';
            }
            
            views.forEach(id => {
                const viewElement = document.getElementById(id);
                if (viewElement) {
                    viewElement.style.display = 'none';
                }
            });
            const welcomeBanner = document.querySelector('.welcome-banner');
            if (welcomeBanner) welcomeBanner.style.display = 'none';
            const quoteSection = document.querySelector('.quote-section');
            if (quoteSection) quoteSection.style.display = 'none';
            const globalNoticeOverlay = document.getElementById('globalNoticeOverlay');
            if (globalNoticeOverlay) {
                globalNoticeOverlay.classList.remove('active');
                globalNoticeOverlay.style.display = 'none';
            }
            document.getElementById('telegramChannelsBanner').style.display = 'none';
            document.getElementById('discoverNotice').style.display = 'none';
        }

        window.showHomeView = function() {
            hideAllViews();
            document.getElementById('home-view').style.display = 'grid';
            document.querySelector('.welcome-banner').style.display = 'flex';
            document.querySelector('.quote-section').style.display = 'block';
            
            const telegramBanner = document.getElementById('telegramChannelsBanner');
            if (telegramBanner && window.siteConfig.telegramBannerVisible) {
                telegramBanner.style.display = 'flex';
            }
            const discoverNotice = document.getElementById('discoverNotice');
            if (discoverNotice && window.siteConfig.discoverNoticeVisible) {
                discoverNotice.style.display = 'block';
            }

            currentView = 'home-view';
            window.highlightBottomNav('home-nav');
            window.scrollTo(0, 0);
            updateWelcomeSection();
            renderCategories();
        }

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible-on-scroll');
                }
            });
        }, { threshold: 0.1 });
        function loadAllCategoriesFromFirebase() {
            onValue(dbRef(rtdb, 'categories'), (snapshot) => {
                allCategoriesData = snapshot.val() || {};
                renderCategories();
            }, (error) => {
                document.getElementById('loadingCategoriesMessage').textContent = `Error loading categories: ${error.message}`;
            });
        }

        const loadSiteConfigAndApply = () => {
            onValue(dbRef(rtdb, 'siteConfig'), (snapshot) => {
                const config = snapshot.val() || {};
                window.siteConfig = { ...window.siteConfig, ...config };
                
                const loadingOverlay = document.getElementById('loadingScreenOverlay');
                if (window.siteConfig.loadingScreenEnabled) {
                    document.getElementById('loadingScreenLogo').src = window.siteConfig.loadingScreenLogoUrl || 'https://i.ibb.co/b3bSg0B/images-1-removebg-preview.png';
                    document.getElementById('loadingScreenName').textContent = window.siteConfig.loadingScreenName || 'SKILLNEAST';
                    document.getElementById('loadingScreenTagline').textContent = window.siteConfig.loadingScreenTagline || 'NAVIGATION YOUR SKILL 🚀💡';
                    
                    // The loading screen is already visible. Schedule its removal.
                    setTimeout(() => {
                        loadingOverlay.classList.add('hidden'); // Fades out the loader
                        document.body.classList.remove('loading-active'); // Reveals the main content
                        
                        // After fade transition (0.5s), set display to none to remove from layout
                        setTimeout(() => { 
                            loadingOverlay.style.display = 'none';
                        }, 500); 

                    }, 3500); // This should match the total time you want the loader visible

                } else {
                    // If disabled, hide it immediately and show content.
                    loadingOverlay.style.display = 'none';
                    document.body.classList.remove('loading-active');
                }


                document.getElementById('skillNeastLogo').src = window.siteConfig.skillNeastLogoUrl || 'https://via.placeholder.com/40x40/00ADB5/ffffff?text=SN';
                window.openTodaySurpriseLink = () => {
                    const link = window.siteConfig.surpriseButtonLink || '#';
                    if (link && link !== '#') {
                        window.open(link, '_blank');
                    } else {
                        alert('No surprise link available yet! Check back later. 🎉');
                    }
                };
        
                document.querySelector('.surprise-button').onclick = window.openTodaySurpriseLink;

                document.querySelector('.top-navbar .telegram-icon').onclick = () => window.open(window.siteConfig.telegramGroupLink || 'https://t.me/', '_blank');
                document.getElementById('aboutMeProfilePic').src = window.siteConfig.profilePictureUrl || 'https://via.placeholder.com/120x120/00ADB5/ffffff?text=Fahad';
                document.getElementById('aboutMeTelegramGroupLink').href = window.siteConfig.telegramGroupLink || 'https://t.me/';
                document.getElementById('aboutMeInstagramLink').href = window.siteConfig.instagramLink || 'https://instagram.com/';
                document.getElementById('aboutMeYoutubeLink').href = window.siteConfig.youtubeLink || 'https://www.youtube.com/';
                document.getElementById('sliderHeaderLogo').src = window.siteConfig.sliderHeaderPictureUrl || 'https://via.placeholder.com/50x50/00ADB5/ffffff?text=SN';
                document.getElementById('sliderTelegramChannelLink').href = window.siteConfig.telegramChannelLink || 'https://t.me/';
                document.getElementById('sliderTelegramGroupLink').href = window.siteConfig.telegramGroupLink || 'https://t.me/';
                document.getElementById('sliderRequestCoursesLink').href = window.siteConfig.requestCoursesLink || '#';

                console.log("Site configuration applied.");

                // --- Populate Telegram Channels Banner (WE NEED) ---
                const telegramBanner = document.getElementById('telegramChannelsBanner');
                const telegramMainTitle = document.getElementById('telegramBannerMainTitle');
                const telegramChannelList = document.getElementById('telegramBannerChannelList');
                const telegramButton = document.getElementById('telegramBannerButton');
                const telegramSupportText = document.getElementById('telegramBannerSupportText');
                if (telegramBanner && telegramMainTitle && telegramChannelList && telegramButton && telegramSupportText) { // Safety check
                    if (window.siteConfig.telegramBannerVisible) {
                        telegramBanner.style.display = 'flex';
                        telegramMainTitle.innerHTML = window.siteConfig.telegramBannerTitle || 'JOIN OUR OFFICIAL <br> TELEGRAM CHANNELS';
                        telegramSupportText.textContent = window.siteConfig.telegramBannerSupportText || 'YOUR SUPPORT !!';
                        telegramButton.textContent = window.siteConfig.telegramBannerButtonText || 'CLICK HERE!';
                        telegramButton.onclick = () => window.open(window.siteConfig.telegramBannerButtonLink || window.siteConfig.telegramGroupLink || 'https://t.me/', '_blank');

                        telegramChannelList.innerHTML = '';
                        if (window.siteConfig.telegramBannerChannelList) {
                            const channels = window.siteConfig.telegramBannerChannelList.split('|');
                            channels.forEach(channelText => {
                                const span = document.createElement('span');
                                span.innerHTML = channelText.trim();
                                telegramChannelList.appendChild(span);
                            });
                        } else {
                            telegramChannelList.innerHTML = `
                                <span>• Study Ratna <i class="fas fa-book-reader"></i></span>
                                <span>• RATNA Official <i class="fas fa-bullhorn"></i></span>
                                <span>• Anime Speaks <i class="fas fa-dragon"></i></span>
                                <span>• Code with RATNA <i class="fas fa-code"></i></span>
                            `;
                        }
                    } else {
                        telegramBanner.style.display = 'none';
                    }
                }

                // --- Populate Discover Notice (Namo Buddhaya Everyone) ---
                const discoverNotice = document.getElementById('discoverNotice');
                const discoverNoticeHeader = document.getElementById('discoverNoticeHeader');
                const discoverNoticeMainTitle = document.getElementById('discoverNoticeMainTitle');
                const discoverNoticePoints = document.getElementById('discoverNoticePoints');
                const discoverNoticeImage = document.getElementById('discoverNoticeImage');
                if (discoverNotice && discoverNoticeHeader && discoverNoticeMainTitle && discoverNoticePoints && discoverNoticeImage) { // Safety check
                    if (window.siteConfig.discoverNoticeVisible) {
                        discoverNotice.style.display = 'block';
                        discoverNoticeHeader.innerHTML = `${window.siteConfig.discoverNoticeHeaderEmoji || '🙏'} Namo Buddhaya Everyone ${window.siteConfig.discoverNoticeHeaderEmoji || '🙏'}`;
                        discoverNoticeMainTitle.textContent = window.siteConfig.discoverNoticeTitle || 'DISCOVER OUR APP\'S DELIGHTS!';
                        if (window.siteConfig.discoverNoticeImageUrl) {
                            discoverNoticeImage.src = window.siteConfig.discoverNoticeImageUrl;
                            discoverNoticeImage.style.display = 'block';
                            discoverNoticeImage.onclick = () => window.openFullscreenImage(discoverNoticeImage.src);
                        } else {
                            discoverNoticeImage.style.display = 'none';
                        }

                        discoverNoticePoints.innerHTML = '';
                        if (window.siteConfig.discoverNoticePoints) {
                            const points = window.siteConfig.discoverNoticePoints.split('|');
                            points.forEach(pointText => {
                                const li = document.createElement('li');
                                li.innerHTML = pointText.trim();
                                discoverNoticePoints.appendChild(li);
                            });
                        } else {
                            discoverNoticePoints.innerHTML = `
                                <li><span class="emoji-inline">🚫</span>Don\'t buy this App from AnyOne. This App is Free 🆓 of Cost for EveryOne. Unfortunately, If you Purchased this App, then please report! that user who sold you this App and take your Money Back.</li>
                                <li><span class="emoji-inline">🤝</span> Join Us on Telegram : Scam se bachne ke liye, Get updates, mentorship, and connect with us.</li>
                            `;
                        }
                        loadDiscoverNoticeReactions();
                    } else {
                        discoverNotice.style.display = 'none';
                    }
                }

            }, (error) => console.error("Error loading site config:", error));
        };
        function loadHowToUseVideosForWebsite() {
            onValue(dbRef(rtdb, 'siteConfig/howToUseVideos'), (snapshot) => {
                const howToUseAppView = document.getElementById('how-to-use-app-view');
                const videoContainer = howToUseAppView?.querySelector('.video-container'); // Safely access
                const descriptionParagraph = howToUseAppView?.querySelector('p:first-of-type'); // Safely access

                if (!videoContainer) return; // Exit if container not found

                videoContainer.innerHTML = '';
      
                if (descriptionParagraph) {
                    descriptionParagraph.textContent = '';
                }

                const videos = snapshot.val();
                if (videos) {
                    const firstVideoId = Object.keys(videos)[0];
                    const firstVideo = videos[firstVideoId];
                    if (firstVideo && firstVideo.url) {
                        const videoInfo = extractVideoId(firstVideo.url);
                        if (videoInfo) {
                            let embedUrl = '';
                            if (videoInfo.type === 'gdrive') {
                                embedUrl = `https://drive.google.com/embed?id=${videoInfo.id}`;
                            } else if (videoInfo.type === 'youtube') {
                                embedUrl = `https://www.youtube-nocookie.com/embed/${videoInfo.id}?autoplay=0`;
                            }
                            if (embedUrl) {
                                videoContainer.innerHTML = `<iframe src="${embedUrl}" frameborder="0" allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen" allowfullscreen></iframe>`;
                            } else {
                                videoContainer.innerHTML = `<p style="color: var(--text-light); text-align: center; padding: 20px;">Unsupported video URL for embedding or video not accessible.</p>`;
                            }
                        }
                    }
                    if (firstVideo && firstVideo.description && descriptionParagraph) {
                        descriptionParagraph.textContent = firstVideo.description;
                    } else if (descriptionParagraph) {
                        descriptionParagraph.textContent = "Welcome to SkillNeast! This video will guide you through all the features of our app, from navigating courses to managing your favorites and interacting with our community.";
                    }
                } else {
                    videoContainer.innerHTML = `<p style="color: var(--text-light); text-align: center; padding: 20px;">No tutorial video available yet.</p>`;
                    if (descriptionParagraph) {
                        descriptionParagraph.textContent = "Welcome to SkillNeast! This video will guide you through all the features of our app, from navigating courses to managing your favorites and interacting with our community.";
                    }
                }
            }, (error) => {
                console.error("Error loading how-to-use videos for website:", error);
                const howToUseAppView = document.getElementById('how-to-use-app-view');
                if (howToUseAppView) howToUseAppView.querySelector('.video-container').innerHTML = `<p style="color: red; text-align: center; padding: 20px;">Error loading tutorial video.</p>`;
            });
        }

        function renderCategories() {
            const homeView = document.getElementById('home-view');
            const dynamicCategoriesContainer = homeView.querySelector('#dynamic-categories-container');
            
            if (!dynamicCategoriesContainer) return; // Safety check

            Array.from(dynamicCategoriesContainer.querySelectorAll('.course-category-item')).forEach(el => el.remove());
            const loadingMessage = dynamicCategoriesContainer.querySelector('#loadingCategoriesMessage');
            if (loadingMessage) loadingMessage.remove(); // Remove message if it exists

            if (allCategoriesData && Object.keys(allCategoriesData).length > 0) { // Check if there's actual data
                const sortedCategories = Object.entries(allCategoriesData).sort(([, catA], [, catB]) => {
                    const nameA = catA.name ? catA.name.toLowerCase() : '';
                    const nameB = catB.name ? catB.name.toLowerCase() : '';
                    
                    return nameA.localeCompare(nameB);
                });
                sortedCategories.forEach(([catId, category]) => {
                    const categoryItem = document.createElement('div');
                    categoryItem.className = 'course-category-item hidden-on-scroll';
                    categoryItem.onclick = () => window.showNewBatchesView(catId);
                    const imageUrl = category.imageUrl || 'https://via.placeholder.com/180x180/00ADB5/1A2B3C?text=Course';
 
                    categoryItem.innerHTML = `
                        <div class="image-container">
                            <img src="${imageUrl}" alt="${category.name}" draggable="false" onerror="this.onerror=null;this.src='https://via.placeholder.com/180x180/00ADB5/1A2B3C?text=No+Img';">
                        </div>
                        <div class="content-overlay">
                            <span class="category-name">${category.name}</span>
                        </div>
                    `;
                    dynamicCategoriesContainer.appendChild(categoryItem);
                    observer.observe(categoryItem);
                });
            } else {
                dynamicCategoriesContainer.innerHTML = `<p class="text-center text-muted col-span-full">No categories available.</p>`;
            }
        }

        window.showNewBatchesView = function(categoryId = 'all') {
            hideAllViews();
            document.getElementById('new-batches-view').style.display = 'block';
            currentView = 'new-batches-view';
            window.lastCategoryViewed = categoryId;
            const batchSearchInput = document.getElementById('batchSearchInput');
            if(batchSearchInput) batchSearchInput.value = '';
            
            const batchesContainer = document.getElementById('batches-container');
            if(batchesContainer) batchesContainer.innerHTML = '';

            let batchesToDisplay = [];
            if (categoryId === 'all') {
                const newBatchesTitle = document.getElementById('new-batches-title');
                if(newBatchesTitle) newBatchesTitle.textContent = 'All Courses';
                Object.values(allCategoriesData).forEach(category => {
                    if (category.batches) {
                        const publicBatches = Object.keys(category.batches)
                                            .map(key => ({ id: key, ...category.batches[key] }))
                                            .filter(batch => batch.isPublic); 
                        batchesToDisplay.push(...publicBatches);
                    }
                });
            } else {
                const selectedCategory = allCategoriesData[categoryId];
                const newBatchesTitle = document.getElementById('new-batches-title');
                if(newBatchesTitle) newBatchesTitle.textContent = selectedCategory ? selectedCategory.name + ' Courses' : 'Courses';
                if (selectedCategory && selectedCategory.batches) {
                    batchesToDisplay = Object.keys(selectedCategory.batches)
                           .map(key => ({ id: key, ...selectedCategory.batches[key] }))
                                        .filter(batch => batch.isPublic);
                }
            }
            batchesToDisplay.sort((a, b) => (a.title || '').localeCompare(b.title || ''));
            displayBatches(batchesToDisplay);
            window.highlightBottomNav('courses-nav');
            window.scrollTo(0, 0);
        }

        function displayBatches(batchesToDisplay) {
            const batchesContainer = document.getElementById('batches-container');
            if(!batchesContainer) return;

            batchesContainer.innerHTML = '';
            if (batchesToDisplay.length === 0) {
                batchesContainer.innerHTML = '<p style="text-align: center; color: var(--text-light);">No batches found.</p>';
                return;
            }
            batchesToDisplay.forEach(batch => {
                const batchCard = document.createElement('div');
                batchCard.className = 'batch-card hidden-on-scroll';
                const isFavorited = window.favorites.includes(batch.id);
                const heartIconClass = isFavorited ? 'fas fa-heart' : 'far fa-heart';

                let priceHtml = '';
                if (batch.isFree) {
                    priceHtml = `<span class="fw-bold text-success">FREE</span>`;
                    if (batch.originalPrice && batch.originalPrice > 0) {
                        priceHtml += `<span class="original-price-strikethrough"> ₹${batch.originalPrice}</span>`;
                    }
                } else {
                    if (batch.discountedPrice !== undefined && batch.discountedPrice !== null && batch.originalPrice !== undefined && batch.originalPrice !== null && batch.discountedPrice < batch.originalPrice) {
                        priceHtml = `<span style="font-weight: bold;">₹${batch.discountedPrice}</span> <span class="original-price-strikethrough">₹${batch.originalPrice}</span>`;
                    } else if (batch.discountedPrice !== undefined && batch.discountedPrice !== null) { 
                        priceHtml = `<span style="font-weight: bold;">₹${batch.discountedPrice}</span>`;
                    } else if (batch.originalPrice !== undefined && batch.originalPrice !== null) { 
                        priceHtml = `<span style="font-weight: bold;">₹${batch.originalPrice}</span>`;
                    } else {
                        priceHtml = `Price N/A`;
                    }
                }

                let descriptionHtml = '';
                if (batch.description) {
                    const lines = batch.description.split('\n').filter(line => line.trim() !== '');
                    descriptionHtml = lines.map(line => `<div class="batch-description-feature"><i class="fas fa-check-circle"></i> ${line.trim()}</div>`).join('');
                } else {
                    descriptionHtml = `<div class="batch-description-feature"><i class="fas fa-check-circle"></i> No description available.</div>`;
                }
                
                let actionButtonHtml = '';
                if (batch.isContentDirectLink) {
                    actionButtonHtml = `<button class="access-content-button" onclick="window.open('${batch.directDriveLink}', '_blank')">ACCESS CONTENT <i class="fas fa-globe"></i></button>`;
                } else {
                    let letsRoarAction;
                    let letsRoarButtonText;

                    if (batch.isFree) {
                        letsRoarAction = `window.showSectionsView('${batch.id}')`;
                        letsRoarButtonText = "LET'S ROAR 🚀🔥";
                    } else {
                        letsRoarAction = `window.open('${batch.telegramCourseLink || window.siteConfig.telegramGroupLink || 'https://t.me/'}', '_blank')`;
                        letsRoarButtonText = "JOIN TELEGRAM 📞";
                    }
                    actionButtonHtml = `<button class="lets-roar-button" onclick="${letsRoarAction}">${letsRoarButtonText}</button>`;
                }

                // NEW: Badges for New/Free/Paid status
                let newBadgeHtml = '';
                if (batch.isNew) {
                    newBadgeHtml = `<span class="badge new">NEW!</span>`;
                }

                let typeBadgeHtml = '';
                if (batch.isFree) {
                    typeBadgeHtml = `<span class="badge free">FREE</span>`;
                } else {
                    typeBadgeHtml = `<span class="badge paid">PAID</span>`;
                }

                batchCard.innerHTML = `
                    <div class="batch-card-header">
                        <div class="icons">
                            <i class="${heartIconClass}" onclick="event.stopPropagation(); window.toggleFavorite('${batch.id}', this);"></i>
                        </div>
                        <div class="batch-title-wrapper">
                            <span class="batch-title">${batch.title}</span>
                        </div>
                        <div class="batch-badges">
                            ${typeBadgeHtml}
                            ${newBadgeHtml}
                        </div>
                    </div>
                    <div class="batch-card-body">
                        <div class="batch-image-container">
                            <img src="${batch.thumbnail}" alt="${batch.title}" draggable="false" onerror="this.onerror=null;this.src='https://via.placeholder.com/200x150/00ADB5/1A2B3C?text=No+Img';">
                        </div>
                        <p class="batch-price" style="margin-bottom: 15px;">${priceHtml}</p>
                        <div class="batch-description">${descriptionHtml}</div>
                        ${actionButtonHtml}
                    </div>`;
                batchesContainer.appendChild(batchCard);
                observer.observe(batchCard);
            });
        }

        window.filterBatches = function() {
            const searchTerm = document.getElementById('batchSearchInput')?.value.toLowerCase();
            let currentCategoryBatches = [];
            if (window.lastCategoryViewed === 'all') {
                Object.values(allCategoriesData).forEach(category => {
                    if (category.batches) {
                        currentCategoryBatches.push(...Object.keys(category.batches).map(key => ({ id: key, ...category.batches[key] })));
                    }
                });
            } else {
                const cat = allCategoriesData[window.lastCategoryViewed];
                if (cat && cat.batches) {
                    currentCategoryBatches = Object.keys(cat.batches).map(key => ({ id: key, ...cat.batches[key] }));
                }
            }
            // Filter by public status first, then by search term
            const filtered = currentCategoryBatches.filter(b => 
                b.isPublic && 
                ((b.title || '').toLowerCase().includes(searchTerm || '') || ((b.description || '').toLowerCase().includes(searchTerm || '')))
            );
            displayBatches(filtered);
        }

        window.toggleFavorite = function(batchId, iconElement) {
            const index = window.favorites.indexOf(batchId);
            if (index > -1) { 
                window.favorites.splice(index, 1);
                iconElement.classList.replace('fas', 'far');
            } else {
                window.favorites.push(batchId);
                iconElement.classList.replace('far', 'fas');
            }
            localStorage.setItem('favorites', JSON.stringify(window.favorites));
            renderFavoritesSectionHomeCard();
            if (currentView === 'favorites-view') window.showFavoritesView();
        }

        function renderFavoritesSectionHomeCard() {
            const favoritesCountElement = document.getElementById('favorites-count');
            if (favoritesCountElement) { // Safely access
                favoritesCountElement.textContent = `${window.favorites.length} Batches`;
            }
        }

        window.showFavoritesView = function() {
            hideAllViews();
            document.getElementById('favorites-view').style.display = 'block';
            currentView = 'favorites-view';
            window.highlightBottomNav('home-nav');
            const container = document.getElementById('favorite-batches-container');
            const msgView = document.getElementById('no-favorites-message-view');
            
            if(!container || !msgView) return;

            container.innerHTML = '';
            if (window.favorites.length === 0) {
                msgView.style.display = 'block';
            } else {
                msgView.style.display = 'none';
                let favBatches = [];
                window.favorites.forEach(favId => {
                    for (const catId in allCategoriesData) {
                        if (allCategoriesData[catId].batches && allCategoriesData[catId].batches[favId]) {
                            if (allCategoriesData[catId].batches[favId].isPublic) {
                                favBatches.push({ id: favId, ...allCategoriesData[catId].batches[favId] });
                            }
                            break;
                        }
                    }
                });
                displayBatches(favBatches);
            }
            window.scrollTo(0, 0);
        }

        window.showSectionsView = function(batchId) {
            hideAllViews();
            currentBatchId = batchId;
            let selectedBatch = null;
            let currentCategoryId = null;
            for (const catId in allCategoriesData) {
                if (allCategoriesData[catId].batches && allCategoriesData[catId].batches[batchId]) {
                    selectedBatch = allCategoriesData[catId].batches[batchId];
                    currentCategoryId = catId;
                    break;
                }
            }

            const container = document.getElementById('sections-container');
            const titleEl = document.getElementById('sections-title');
            
            if(!container || !titleEl) return;

            container.innerHTML = '';
            if (!selectedBatch) {
                alert('Error: Batch details could not be found. It might have been deleted.');
                window.showHomeView();
                return;
            }

            if (selectedBatch.isContentDirectLink && selectedBatch.directDriveLink) {
                titleEl.textContent = selectedBatch.title + ' Content';
                const directLinkWarning = document.createElement('div');
                directLinkWarning.className = 'batch-card mb-4';
                directLinkWarning.innerHTML = `
                    <div class="batch-card-body text-center">
                        <h3 class="batch-title" style="color: var(--highlight-gold);">Direct Content Available! <i class="fas fa-external-link-alt"></i></h3>
                        <p class="batch-description">This batch has external content. Click the button below to access it.</p>
                        <button class="access-content-button" onclick="window.open('${selectedBatch.directDriveLink}', '_blank');">
                            ACCESS CONTENT <i class="fas fa-globe"></i>
                        </button>
                    </div>
                `;
                container.appendChild(directLinkWarning);
                document.getElementById('sections-view').style.display = 'block';
            } else {
                titleEl.textContent = selectedBatch.title + ' Modules';
                document.getElementById('sections-view').style.display = 'block';

                const modulesData = selectedBatch.modules || {};
                // Filter for public modules
                const publicModules = Object.entries(modulesData).filter(([, module]) => module.isPublic);
                if (publicModules.length === 0) {
                    container.innerHTML = `<p style="text-align: center; color: var(--text-light); padding: 20px;">No public modules available for this batch yet.</p>`;
                } else {
                    publicModules.forEach(([modId, module]) => {
                        const moduleItem = document.createElement('div');
                        moduleItem.className = 'section-item hidden-on-scroll';
                     
                        moduleItem.onclick = () => window.showLessonsInSectionsView(batchId, modId);

                        const lecturesCount = Object.values(module.lectures || {}).filter(item => item.type === 'lecture' && item.isPublic).length; 
                        const resourcesCount = Object.values(module.lectures || {}).filter(item => item.type === 'resource' && item.isPublic).length; 

                        let countsText = '';
                        if (lecturesCount > 0 && resourcesCount > 0) {
                            countsText = `<span>${lecturesCount} Lectures</span> | <span>${resourcesCount} Resources</span>`;
                        } else if (lecturesCount > 0) {
                            countsText = `<span>${lecturesCount} Lectures</span>`;
                        } else if (resourcesCount > 0) {
                            countsText = `<span>${resourcesCount} Resources</span>`;
                        } else {
                            countsText = `<span>No Content</span>`;
                        }

                        moduleItem.innerHTML = `
                            <div class="section-item-content">
                                <h3 class="section-name">${module.name || 'Untitled Module'}</h3>
                                <p class="section-counts">${countsText}</p>
                            </div>
                            <div class="section-arrow"><i class="fas fa-chevron-right"></i></div>
                        `;
                        container.appendChild(moduleItem);
                        observer.observe(moduleItem);
                    });
                }
            }
            window.scrollTo(0, 0);
        };

        window.goBackFromLessonsList = function() {
            window.showSectionsView(currentBatchId);
        };
        window.showLessonsInSectionsView = function(batchId, sectionId) {
            hideAllViews();
            currentBatchId = batchId;
            currentSectionIndex = sectionId;
            document.getElementById('lessons-in-sections-view').style.display = 'block';
            
            let selectedBatch = null;
            for (const catId in allCategoriesData) {
                if (allCategoriesData[catId].batches && allCategoriesData[catId].batches[batchId]) {
                    selectedBatch = allCategoriesData[catId].batches[batchId];
                    break;
                }
            }

            const lessonsInSectionsTitle = document.getElementById('lessons-in-sections-title');
            const lessonsContainer = document.getElementById('lessons-in-sections-container');

            if(!lessonsInSectionsTitle || !lessonsContainer) return;

            if (!selectedBatch || !selectedBatch.modules || !selectedBatch.modules[sectionId]) {
                alert('Error: Module not found.');
                window.goBackFromLessonsList();
                return;
            }

            const selectedModule = selectedBatch.modules[sectionId];
            lessonsInSectionsTitle.textContent = selectedModule.name || 'Module Content';
            lessonsContainer.innerHTML = '';

            const items = selectedModule.lectures ? Object.values(selectedModule.lectures) : [];
            const lectures = items.filter(item => item.type === 'lecture' && item.isPublic);
            const resources = items.filter(item => item.type === 'resource' && item.isPublic);
            if (lectures.length > 0) {
                const lecturesHeader = document.createElement('h3');
                lecturesHeader.className = 'content-category-header';
                lecturesHeader.innerHTML = `<i class="fas fa-play-circle"></i> Lectures 🎬`;
                lessonsContainer.appendChild(lecturesHeader);

                const lecturesList = document.createElement('div');
                lecturesList.className = 'content-list-container';
                lectures.forEach(lecture => {
                    const lectureItem = document.createElement('div');
                    lectureItem.className = 'lesson-list-item hidden-on-scroll';
                    lectureItem.onclick = () => window.showVideoPlayerView(batchId, sectionId, lecture.url, lecture.name);
                    lectureItem.innerHTML = `
                        <div class="lesson-list-item-right">
                            <h3 class="lesson-list-item-title">${lecture.name || 'Untitled Lecture'}</h3>
                        </div>
                        <div class="video-icon-overlay"><i class="fas fa-video"></i></div>
                    `;
                    lecturesList.appendChild(lectureItem);
                    observer.observe(lectureItem);
                });
                lessonsContainer.appendChild(lecturesList);
            }

            if (resources.length > 0) {
                const resourcesHeader = document.createElement('h3');
                resourcesHeader.className = 'content-category-header';
                resourcesHeader.innerHTML = `<i class="fas fa-file-alt"></i> Resources 📚`;
                lessonsContainer.appendChild(resourcesHeader);

                const resourcesList = document.createElement('div');
                resourcesList.className = 'content-list-container';
                resources.forEach(resource => {
                    const resourceItem = document.createElement('div');
                    resourceItem.className = 'lesson-list-item hidden-on-scroll';
                    resourceItem.onclick = () => {
                        window.open(resource.url, '_blank');
                    };
                    let resourceIconClass = 'fas fa-link';
                    const resourceExtension = getFileExtension(resource.url, resource.name).toLowerCase();
                    if (resourceExtension === 'pdf') {
                        resourceIconClass = 'fas fa-file-pdf';
                    } else if (['zip', 'rar', '7z'].includes(resourceExtension)) {
                        resourceIconClass = 'fas fa-file-archive';
                    } else if (['jpg', 'jpeg', 'png', 'gif'].includes(resourceExtension)) {
                        resourceIconClass = 'fas fa-image';
                    } else if (resourceExtension === 'gem') {
                        resourceIconClass = 'fas fa-gem';
                    } else {
                        resourceIconClass = 'fas fa-link';
                    }

                    resourceItem.innerHTML = `
                        <div class="lesson-list-item-right">
                            <h3 class="lesson-list-item-title">${resource.name || 'Untitled Resource'}</h3>
                        </div>
                        <div class="video-icon-overlay"><i class="${resourceIconClass}" style="color: var(--accent-teal);"></i></div>
                    `;
                    resourcesList.appendChild(resourceItem);
                    observer.observe(resourceItem);
                });
                lessonsContainer.appendChild(resourcesList);
            }

            if (lectures.length === 0 && resources.length === 0) {
                lessonsContainer.innerHTML = `<p style="text-align: center; color: var(--text-light); padding: 20px;">No lectures or resources available in this module yet.</p>`;
            }
            window.scrollTo(0, 0);
        };
        window.goBackFromPlayerView = function() {
            if (currentBatchId && currentSectionIndex !== null) {
                window.showLessonsInSectionsView(currentBatchId, currentSectionIndex);
            } else {
                window.showNewBatchesView(window.lastCategoryViewed);
            }
        };

        window.showVideoPlayerView = function(batchId, sectionId, videoUrl, lectureTitle) {
            hideAllViews();
            document.getElementById('video-player-view').style.display = 'block';
            currentView = 'video-player-view';
            const videoInfoForLike = extractVideoId(videoUrl);
            window.currentPlayingLectureId = videoInfoForLike ? videoInfoForLike.id : videoUrl;
            currentBatchId = batchId;
            currentSectionIndex = sectionId;

            const playerTitleElement = document.getElementById('player-view-title');
            const lessonSubTitleElement = document.getElementById('player-lesson-sub-title');
            const videoPlayerContainer = document.getElementById('main-video-player');
            const lessonsForPlayerBatchContainer = document.getElementById('lessons-for-player-batch');
            if(!playerTitleElement || !lessonSubTitleElement || !videoPlayerContainer || !lessonsForPlayerBatchContainer) return;

            playerTitleElement.textContent = lectureTitle;
            lessonSubTitleElement.textContent = lectureTitle;
            videoPlayerContainer.innerHTML = '';

            const videoInfo = extractVideoId(videoUrl);
            if (videoInfo) {
                let embedUrl = '';
                if (videoInfo.type === 'gdrive') {
                    embedUrl = `https://drive.google.com/file/d/${videoInfo.id}/preview`;
                } else if (videoInfo.type === 'youtube') {
                    embedUrl = `https://www.youtube-nocookie.com/embed/${videoInfo.id}?autoplay=1`;
                }
                if (embedUrl) {
                    videoPlayerContainer.innerHTML = `<iframe src="${embedUrl}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen" allowfullscreen></iframe>`;
                } else {
                    videoPlayerContainer.innerHTML = `<p style="color: var(--text-light); text-align: center; padding: 20px;">Unsupported video URL for embedding or video not accessible.</p>`;
                }
            } else {
                videoPlayerContainer.innerHTML = `<p style="color: var(--text-light); text-align: center; padding: 20px;">Invalid video URL format.</p>`;
            }

            const likeButton = document.getElementById('likeButton');
            const likeCountDisplay = document.getElementById('likeCountDisplay');
            if(likeButton && likeCountDisplay) { 
                likeButton.classList.remove('liked');
                likeCountDisplay.textContent = '0';
                updateLikeButtonState();
            }

            window.updateQuote();

            lessonsForPlayerBatchContainer.innerHTML = '';
            let selectedBatch = null;
            for (const catId in allCategoriesData) {
                if (allCategoriesData[catId].batches && allCategoriesData[catId].batches[batchId]) {
                    selectedBatch = allCategoriesData[catId].batches[batchId];
                    break;
                }
            }

            if (selectedBatch && selectedBatch.modules && selectedBatch.modules[sectionId] && selectedBatch.modules[sectionId].lectures) {
                const allLecturesInModule = Object.values(selectedBatch.modules[sectionId].lectures).filter(item => item.type === 'lecture' && item.isPublic);
                allLecturesInModule.forEach(lesson => {
                    const lessonItem = document.createElement('li');
                    lessonItem.className = 'lesson-item';
                    lessonItem.onclick = () => window.showVideoPlayerView(batchId, sectionId, lesson.url, lesson.name);
                    lessonItem.innerHTML = `<h3>${lesson.name}</h3>`;
                    lessonsForPlayerBatchContainer.appendChild(lessonItem);
                });
            }
            window.scrollTo(0, 0);
        };
        window.showVideoPlayerViewFromDrive = function(videoUrl, videoName) {
            hideAllViews();
            document.getElementById('video-player-view').style.display = 'block';
            currentView = 'video-player-view';
            const videoInfoForLike = extractVideoId(videoUrl);
            window.currentPlayingLectureId = videoInfoForLike ? videoInfoForLike.id : videoUrl;
            currentBatchId = null;
            currentSectionIndex = null;
            const playerTitleElement = document.getElementById('player-view-title');
            const lessonSubTitleElement = document.getElementById('player-lesson-sub-title');
            const videoPlayerContainer = document.getElementById('main-video-player');
            const lessonsForPlayerBatchContainer = document.getElementById('lessons-for-player-batch');
            if(!playerTitleElement || !lessonSubTitleElement || !videoPlayerContainer || !lessonsForPlayerBatchContainer) return;

            playerTitleElement.textContent = videoName;
            lessonSubTitleElement.textContent = videoName;
            videoPlayerContainer.innerHTML = '';

            const videoInfo = extractVideoId(videoUrl);
            if (videoInfo) {
                let embedUrl = '';
                if (videoInfo.type === 'gdrive') {
                    embedUrl = `https://drive.google.com/file/d/${videoInfo.id}/preview`;
                } else if (videoInfo.type === 'youtube') {
                    embedUrl = `https://www.youtube-nocookie.com/embed/${videoInfo.id}?autoplay=1`;
                }
                if (embedUrl) {
                    videoPlayerContainer.innerHTML = `<iframe src="${embedUrl}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen" allowfullscreen></iframe>`;
                } else {
                    videoPlayerContainer.innerHTML = `<p style="color: var(--text-light); text-align: center; padding: 20px;">Unsupported video URL for embedding or video not accessible.</p>`;
                }
            } else {
                videoPlayerContainer.innerHTML = `<p style="color: var(--text-light); text-align: center; padding: 20px;">Invalid video URL format.</p>`;
            }

            const likeButton = document.getElementById('likeButton');
            const likeCountDisplay = document.getElementById('likeCountDisplay');
            if(likeButton && likeCountDisplay) { 
                likeButton.classList.remove('liked');
                likeCountDisplay.textContent = '0';
                updateLikeButtonState();
            }

            window.updateQuote();

            lessonsForPlayerBatchContainer.innerHTML = `<p style="text-align: center; color: var(--text-light); padding: 20px;">No additional lessons in this direct link content.</p>`;
            window.scrollTo(0, 0);
        };

        window.toggleFullScreen = function() {
            const iframe = document.querySelector('#main-video-player iframe');
            if (iframe) {
                if (iframe.requestFullscreen) {
                    iframe.requestFullscreen();
                } else if (iframe.mozRequestFullScreen) {
                    iframe.mozRequestFullScreen();
                } else if (iframe.webkitRequestFullscreen) {
                    iframe.webkitRequestFullscreen();
                } else if (iframe.msRequestFullscreen) {
                    iframe.msRequestFullscreen();
                }
            }
        };
        window.highlightBottomNav = function(activeId) {
            document.querySelectorAll('.bottom-navbar .nav-item').forEach(item => {
                item.classList.remove('active');
            });
            const activeItem = document.getElementById(activeId);
            if (activeItem) {
                activeItem.classList.add('active');
            }
        };

        window.showComingSoonView = function(feature) {
            hideAllViews();
            let viewId = '';
            let backAction = 'home';

            switch(feature) {
                case 'timeline':
                    viewId = 'timeline-coming-soon-view';
                    backAction = 'player';
                    break;
                case 'watch-later':
                    viewId = 'watch-later-coming-soon-view';
                    backAction = 'player';
                    break;
                case 'comments-coming-soon':
                    viewId = 'comments-coming-soon-view';
                    backAction = 'player';
                    break;
                case 'bundles':
                    viewId = 'bundles-coming-soon-view';
                    backAction = 'home';
                    break;
                case 'pdfs':
                    viewId = 'pdfs-coming-soon-view';
                    backAction = 'home';
                    break;
                case 'ai-chatbot':
                    viewId = 'ai-chatbot-coming-soon-view';
                    backAction = 'home';
                    break;
                default:
                    alert('Coming soon feature not recognized!');
                    window.showHomeView();
                    return;
            }

            const comingSoonViewElement = document.getElementById(viewId);
            if(comingSoonViewElement) { 
                comingSoonViewElement.style.display = 'flex';
                currentView = viewId;
                const backButton = comingSoonViewElement.querySelector('.back-button');
                if (backButton) {
                    backButton.onclick = () => {
                        if (backAction === 'player') {
                            window.goBackFromPlayerView();
                        } else {
                            window.showHomeView();
                        }
                    };
                }
            }
            window.scrollTo(0,0);
        };
        window.shareApp = async () => {
            if (navigator.share) {
                try {
                    await navigator.share({
                        title: 'SkillNeast App',
                        text: 'Master new skills and boost your knowledge with SkillNeast! Download the app now.',
                        url: window.location.href
                    });
                    console.log('App shared successfully');
                } catch (error) {
                    console.error('Error sharing app:', error);
                }
            } else {
                alert('Web Share API is not supported in this browser. You can manually copy the link: ' + window.location.href);
            }
        };

        window.showAboutMeView = function() {
            hideAllViews();
            document.getElementById('about-me-view').style.display = 'flex';
            currentView = 'about-me-view';
            window.highlightBottomNav('about-me-nav');
            window.scrollTo(0,0);
        };

        window.showHowToUseAppView = function() {
            hideAllViews();
            document.getElementById('how-to-use-app-view').style.display = 'flex';
            currentView = 'how-to-use-app-view';
            window.highlightBottomNav('home-nav'); 
            window.scrollTo(0,0);
        };

        window.openCommentsPopup = function() {
            document.getElementById('commentsPopupOverlay').style.display = 'flex';
            document.getElementById('commentsPopupOverlay').classList.add('active');
            loadComments();
        };

        window.closeCommentsPopup = function() {
            document.getElementById('commentsPopupOverlay').classList.remove('active');
            setTimeout(() => {
                document.getElementById('commentsPopupOverlay').style.display = 'none';
            }, 300);
        };

        window.postComment = async function() {
            if (!isAuthenticated) {
                alert("You need to be authenticated to post comments.");
                return;
            }
            if (!window.currentPlayingLectureId) {
                alert("No lecture selected to comment on.");
                return;
            }

            const commentInput = document.getElementById('commentInput');
            const commentText = commentInput.value.trim();
            const userName = localStorage.getItem('userName') || 'Anonymous';
            if (commentText.length === 0) {
                alert("Comment cannot be empty.");
                return;
            }

            try {
                const commentsRef = dbRef(rtdb, `comments/${window.currentPlayingLectureId}`);
                await push(commentsRef, {
                    userId: currentUserId,
                    userName: userName,
                    text: commentText,
                    timestamp: serverTimestamp()
                });
                commentInput.value = '';
                console.log('Comment posted!');
            } catch (error) {
                console.error("Error posting comment:", error);
                alert("Failed to post comment: " + error.message);
            }
        };
        function loadComments() {
            if (!window.currentPlayingLectureId) {
                const commentsDisplayArea = document.getElementById('commentsDisplayArea');
                if(commentsDisplayArea) { 
                    commentsDisplayArea.innerHTML = '<p class="no-comments-message">No lecture selected for comments.</p>';
                }
                return;
            }

            const commentsRef = dbRef(rtdb, `comments/${window.currentPlayingLectureId}`);
            onValue(commentsRef, (snapshot) => {
                const commentsData = snapshot.val();
                const commentsDisplayArea = document.getElementById('commentsDisplayArea');
                if(!commentsDisplayArea) return;

                commentsDisplayArea.innerHTML = '';

                if (!commentsData) {
                    commentsDisplayArea.innerHTML = '<p class="no-comments-message">No comments yet. Be the first to comment!</p>';
                    return;
                }

                const sortedComments = Object.values(commentsData).sort((a, b) => {
                    const timeA = a.timestamp || 0;
                    const timeB = b.timestamp || 0;
                    return timeA - timeB;
                });

                sortedComments.forEach(comment => {
                    const commentItem = document.createElement('div');
                    commentItem.className = 'comment-item';
                    const timestamp = comment.timestamp ? new Date(comment.timestamp).toLocaleString() : 'N/A';
                    commentItem.innerHTML = `<strong>${comment.userName || 'Anonymous'}:</strong> ${comment.text} <br><small style="color: var(--text-light);">${timestamp}</small>`;
                    commentsDisplayArea.appendChild(commentItem);
                });
                commentsDisplayArea.scrollTop = commentsDisplayArea.scrollHeight;
            }, (error) => {
                console.error("Error loading comments:", error);
                const commentsDisplayArea = document.getElementById('commentsDisplayArea');
                if(commentsDisplayArea) { 
                    commentsDisplayArea.innerHTML = `<p class="no-comments-message" style="color: var(--error-red);">Error loading comments: ${error.message}</p>`;
                }
            });
        }


        // Function to set up the like button
        function setupLikeButton() {
            const likeButton = document.getElementById('likeButton');
            if (likeButton) {
                likeButton.removeEventListener('click', handleLikeButtonClick);
                likeButton.addEventListener('click', handleLikeButtonClick);
            }
        }

        // Function to handle like button click
        async function handleLikeButtonClick() {
            if (!isAuthenticated) {
                alert("You need to be authenticated to like content.");
                return;
            }
            if (!window.currentPlayingLectureId) {
                alert("No lecture selected to like.");
                return;
            }

            const lectureId = window.currentPlayingLectureId;
            const likeRef = dbRef(rtdb, `likes/${lectureId}`);

            const currentLikeStatus = window.userLikes.includes(lectureId);
            
            try {
                if (currentLikeStatus) {
                    window.userLikes = window.userLikes.filter(id => id !== lectureId);
                    // Use increment for atomic operation
                    onValue(likeRef, (snapshot) => {
                        let currentCount = (snapshot.val() && snapshot.val().count) || 0;
                        update(likeRef, { count: Math.max(0, currentCount - 1) });
                    }, { onlyOnce: true });
                } else {
                    window.userLikes.push(lectureId);
                    // Use increment for atomic operation
                    onValue(likeRef, (snapshot) => {
                        let currentCount = (snapshot.val() && snapshot.val().count) || 0;
                        update(likeRef, { count: currentCount + 1 });
                    }, { onlyOnce: true });
                }
                localStorage.setItem('userLikes', JSON.stringify(window.userLikes));
                updateLikeButtonState(); 
            } catch (error) {
                console.error("Error updating like:", error);
                alert("Failed to update like: " + error.message);
                // Revert UI if update fails
                if (currentLikeStatus) {
                    window.userLikes.push(lectureId);
                } else {
                    window.userLikes = window.userLikes.filter(id => id !== lectureId);
                }
                localStorage.setItem('userLikes', JSON.stringify(window.userLikes));
                updateLikeButtonState();
            }
        }

        // Function to update the like button UI (color and count)
        function updateLikeButtonState() {
            const likeButton = document.getElementById('likeButton');
            const likeCountDisplay = document.getElementById('likeCountDisplay');
            const lectureId = window.currentPlayingLectureId;

            if (!likeButton || !likeCountDisplay || !lectureId) return;
            // Update button color/class
            if (window.userLikes.includes(lectureId)) {
                likeButton.classList.add('liked');
            } else {
                likeButton.classList.remove('liked');
            }

            // Listen for real-time like count from Firebase
            const likeCountRef = dbRef(rtdb, `likes/${lectureId}/count`);
            onValue(likeCountRef, (snapshot) => {
                const count = snapshot.val() || 0;
                likeCountDisplay.textContent = count;
            });
        }
        
        // NEW: Batch Notification logic
        // Use an object to store the timestamp of the last notification displayed for each batch
        // Key: batchId, Value: timestamp
        const homepageBatchNotificationState = JSON.parse(localStorage.getItem('homepageBatchNotificationState')) || {};
        let homepageBannerHideTimeoutId = null; // To store the timeout ID for auto-hiding the small banner

        const listenForHomepageBatchNotifications = () => {
            const allBatchesRef = dbRef(rtdb, 'categories');
            onValue(allBatchesRef, (snapshot) => {
                const categoriesData = snapshot.val() || {};
                let foundNotification = false;
                let latestBatchInfo = null; // Store comprehensive info of the latest batch

                const allPublicBatches = [];
                for (const catId in categoriesData) {
                    const category = categoriesData[catId];
                    if (category.batches) {
                        for (const batchId in category.batches) {
                            const batch = category.batches[batchId];
                            if (batch.isPublic) { 
                                allPublicBatches.push({ id: batchId, ...batch });
                            }
                        }
                    }
                }

                allPublicBatches.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));

                if (allPublicBatches.length > 0) {
                    const currentLatestPublicBatch = allPublicBatches[0];
                    const batchTimestamp = currentLatestPublicBatch.timestamp || 0;
                    const lastNotifiedTimestamp = homepageBatchNotificationState[currentLatestPublicBatch.id] || 0;

                    // Only show notification if the batch's timestamp is newer than the last time we notified for THIS SPECIFIC BATCH
                    if (batchTimestamp > lastNotifiedTimestamp) {
                        latestBatchInfo = currentLatestPublicBatch;
                        foundNotification = true;
                    }
                }

                if (foundNotification && latestBatchInfo) {
                    const type = latestBatchInfo.isNew ? 'new' : 'updated';
                    displayHomepageBatchNotification(
                        latestBatchInfo.title, 
                        type, 
                        latestBatchInfo.timestamp, 
                        latestBatchInfo.thumbnail, 
                        latestBatchInfo.id,
                        latestBatchInfo.isFree, // Pass isFree
                        latestBatchInfo.isNew // Pass isNew (for text in banner)
                    );
                    // Update the state for this specific batch, so it doesn't reappear on refresh
                    homepageBatchNotificationState[latestBatchInfo.id] = latestBatchInfo.timestamp;
                    localStorage.setItem('homepageBatchNotificationState', JSON.stringify(homepageBatchNotificationState));
                }

            }, (error) => {
                console.error("Error listening for homepage batch notifications:", error);
            });
        };

        const displayHomepageBatchNotification = (batchName, type, timestamp, batchThumbnailUrl, batchId, isFree, isNewStatus) => {
            const notificationBanner = document.getElementById('homepageBatchNotification');
            const notificationTitleEl = document.getElementById('batchNotificationTitle');
            const notificationMessageBodyEl = document.getElementById('batchNotificationMessageBody');
            const notificationImageEl = document.getElementById('batchNotificationImage');
            const notificationLinkBtn = document.getElementById('batchNotificationLinkBtn');
            if (!notificationBanner || !notificationTitleEl || !notificationMessageBodyEl || !notificationImageEl || !notificationLinkBtn) return;

            if (homepageBannerHideTimeoutId) {
                clearTimeout(homepageBannerHideTimeoutId);
                homepageBannerHideTimeoutId = null;
            }

            let titleText = '';
            let messageText = '';
            let emoji = ''; // Emojis for the message body
            let statusText = ''; // For "New" or "Updated" in the message

            // Determine status text
            if (isNewStatus === true) {
                statusText = "NEW!";
                emoji = "🎉";
            } else {
                statusText = "UPDATED!";
                emoji = "🔔";
            }

            const freePaidText = isFree ? "FREE" : "PAID";

            titleText = `${emoji} Batch ${statusText}: ${batchName}`;
            messageText = `This ${freePaidText} course has fresh content! Check it out.`;
            
            notificationImageEl.src = batchThumbnailUrl;
            notificationLinkBtn.onclick = (e) => {
                e.preventDefault();
                let batchCategoryId = null;
                for (const catId in allCategoriesData) {
                    if (allCategoriesData[catId].batches && allCategoriesData[catId].batches[batchId]) {
                        batchCategoryId = catId;
                        break;
                    }
                }
                if (batchCategoryId) {
                    window.showNewBatchesView(batchCategoryId);
                } else {
                    window.showNewBatchesView('all');
                }
                handleBannerInteraction();
            };
            notificationLinkBtn.style.display = 'inline-block';

            notificationTitleEl.textContent = titleText;
            notificationMessageBodyEl.textContent = messageText;
            
            notificationBanner.classList.remove('new', 'updated'); // Clear previous types
            notificationBanner.classList.add(type); // Add 'new' or 'updated' class for styling

            notificationBanner.style.display = 'flex';
            notificationBanner.style.opacity = 1; 
            notificationBanner.style.visibility = 'visible';
            notificationBanner.style.animation = 'none';
            void notificationBanner.offsetWidth;
            notificationBanner.style.animation = 'slideIn 0.5s forwards';

            // Set a timeout to hide the banner after 8 seconds
            homepageBannerHideTimeoutId = setTimeout(() => {
                notificationBanner.style.animation = 'fadeOut 0.5s forwards'; 
                setTimeout(() => {
                    notificationBanner.style.display = 'none';
                    notificationBanner.style.opacity = 0; 
                    notificationBanner.style.visibility = 'hidden'; 
                }, 500); 
                homepageBannerHideTimeoutId = null;
            }, 8000); // 8 seconds

            const handleBannerInteraction = () => {
                if (homepageBannerHideTimeoutId) {
                    clearTimeout(homepageBannerHideTimeoutId);
                    homepageBannerHideTimeoutId = null;
                }
                notificationBanner.style.animation = 'fadeOut 0.5s forwards';
                setTimeout(() => {
                    notificationBanner.style.display = 'none';
                    notificationBanner.style.opacity = 0;
                    notificationBanner.style.visibility = 'hidden';
                }, 500);
            };

            const notificationIcon = document.getElementById('notificationIcon');
            if (notificationIcon) { 
                notificationIcon.onclick = () => {
                    handleBannerInteraction();
                    window.openNotificationsPopup();
                };
            }
            
            notificationBanner.onclick = () => {
                handleBannerInteraction();
                let batchCategoryId = null;
                for (const catId in allCategoriesData) {
                    if (allCategoriesData[catId].batches && allCategoriesData[catId].batches[batchId]) {
                        batchCategoryId = catId;
                        break;
                    }
                }
                if (batchCategoryId) {
                    window.showNewBatchesView(batchCategoryId);
                } else {
                    window.showNewBatchesView('all');
                }
            };
        };

        // NEW: Firebase Listeners for individual notifications (bell icon)
        const WELCOME_NOTIFICATION_ID = 'welcome_skillneast_v2';

        function listenForNewNotifications() {
            onValue(notificationsRef, (snapshot) => {
                let notificationsData = snapshot.val() || {};
                const notificationsList = document.getElementById('notificationsList');
                let unreadCount = 0;

                if (!notificationsList) return; 

                notificationsList.innerHTML = '';

                let combinedNotifications = [];

                Object.entries(notificationsData).forEach(([notifId, notification]) => {
                    combinedNotifications.push({ id: notifId, ...notification });
                });

                const welcomeNotificationFromStorage = JSON.parse(localStorage.getItem(WELCOME_NOTIFICATION_ID));
           
                if (welcomeNotificationFromStorage) {
                    combinedNotifications.unshift({ 
                        id: WELCOME_NOTIFICATION_ID, 
                        title: welcomeNotificationFromStorage.title, 
                        body: welcomeNotificationFromStorage.body, 
                        link: welcomeNotificationFromStorage.link, 
                        timestamp: welcomeNotificationFromStorage.timestamp,
                        isWelcome: true 
                    });
                }
                
                const finalNotificationsMap = new Map();
                for (const notif of combinedNotifications) {
                    finalNotificationsMap.set(notif.id, notif);
                }
                
                let finalNotifications = Array.from(finalNotificationsMap.values());
                finalNotifications.sort((a, b) => {
                    if (a.id === WELCOME_NOTIFICATION_ID) return -1; 
                    if (b.id === WELCOME_NOTIFICATION_ID) return 1;
                    return (b.timestamp || 0) - (a.timestamp || 0);
                });
                if (finalNotifications.length === 0) {
                    notificationsList.innerHTML = '<p class="no-notifications-message">No new notifications.</p>';
                    updateNotificationBadge(0);
                    return;
                }

                finalNotifications.forEach(notification => {
                    const isRead = window.userNotifications[notification.id] === true;
                    
                    if (!isRead) unreadCount++;

                    const itemDiv = document.createElement('div');
                    itemDiv.className = `notification-item ${isRead ? 'read' : 'unread'}`;
                    itemDiv.dataset.id = notification.id;
                    const timestamp = notification.timestamp ? new Date(notification.timestamp).toLocaleString() : 'N/A';
                    
                    itemDiv.innerHTML = `
                        <div class="notification-item-title">${notification.title || 'Notification'}</div>
                        <div class="notification-item-body">${notification.body || ''}</div>
                        ${notification.link ? `<a href="${notification.link}" target="_blank" class="notification-item-link">View Details</a>` : ''}
                        <div class="notification-item-time">${timestamp}</div>
                    `;
                    if (notification.id !== WELCOME_NOTIFICATION_ID) {
                        itemDiv.onclick = () => markNotificationAsRead(notification.id);
                    } else {
                        itemDiv.onclick = () => window.closeNotificationsPopup();
                    }
                    notificationsList.appendChild(itemDiv);
                });
                updateNotificationBadge(unreadCount);
            }, (error) => {
                console.error("Error fetching notifications:", error);
                const notificationsList = document.getElementById('notificationsList');
                if(notificationsList) { 
                    notificationsList.innerHTML = `<p class="no-notifications-message" style="color: var(--error-red);">Error loading notifications: ${error.message}</p>`;
                }
                updateNotificationBadge(0);
            });
        }

        window.openNotificationsPopup = function() {
            document.getElementById('notificationsPopupOverlay').style.display = 'flex';
            document.getElementById('notificationsPopupOverlay').classList.add('active');
            listenForNewNotifications();
        };

        window.closeNotificationsPopup = function() {
            document.getElementById('notificationsPopupOverlay').classList.remove('active');
            setTimeout(() => {
                document.getElementById('notificationsPopupOverlay').style.display = 'none';
            }, 300);
        };

        function markNotificationAsRead(notifId) {
            window.userNotifications[notifId] = true;
            localStorage.setItem('userNotifications', JSON.stringify(window.userNotifications));
            listenForNewNotifications(); 
        }

        window.markAllNotificationsAsRead = function() {
            onValue(notificationsRef, (snapshot) => {
                const notificationsData = snapshot.val() || {};
                for (const notifId in notificationsData) {
                    window.userNotifications[notifId] = true;
                }
                window.userNotifications[WELCOME_NOTIFICATION_ID] = true; 

                localStorage.setItem('userNotifications', JSON.stringify(window.userNotifications));
                listenForNewNotifications(); 
            }, { onlyOnce: true });
        };

        function updateNotificationBadge(count) {
            const badge = document.getElementById('notificationBadge');
            const notificationIcon = document.getElementById('notificationIcon');
            if (badge && notificationIcon) { 
                if (count > 0) {
                    badge.textContent = count;
                    badge.style.display = 'block';
                    notificationIcon.classList.add('ringing');
                } else {
                    badge.textContent = '0';
                    badge.style.display = 'none';
                    notificationIcon.classList.remove('ringing');
                }
            }
        }

        function showWelcomeNotificationOnce() {
            if (!localStorage.getItem('welcomeNotificationShown')) {
                const welcomeNotification = {
                    title: "Welcome to SkillNeast! 🎉🚀", 
                    body: "Hum aapka SkillNeast par swagat karte hain! Yahan aap naye skills seekh sakte hain aur apne gyaan ko badha sakte hain. Hamari Telegram community se judna na bhulein! ✨📚", 
                    link: window.siteConfig.telegramGroupLink || 'https://t.me/',
                    timestamp: Date.now() 
                };
                window.userNotifications[WELCOME_NOTIFICATION_ID] = true;
                localStorage.setItem('userNotifications', JSON.stringify(window.userNotifications));
                localStorage.setItem(WELCOME_NOTIFICATION_ID, JSON.stringify(welcomeNotification));
                localStorage.setItem('welcomeNotificationShown', 'true');
                listenForNewNotifications(); 
            }
        }

        // --- Firebase Reactions for Discover Notice ---
        const loadDiscoverNoticeReactions = () => {
            onValue(discoverNoticeReactionsRef, (snapshot) => {
                const reactionsData = snapshot.val() || {};
                document.querySelectorAll('.discover-notice-reactions .reaction-icon-discover').forEach(icon => {
                    const reactionType = icon.dataset.reaction;
                    const countSpan = icon.querySelector('.count');
                    if (countSpan) { 
                        const currentCount = reactionsData[reactionType] || 0;
                        countSpan.textContent = currentCount;
                    }

                    if (window.userDiscoverNoticeReactions['discover_notice'] === reactionType) {
                        icon.classList.add('reacted');
                    } else {
                        icon.classList.remove('reacted');
                    }
                });
            });
        };

        document.querySelectorAll('.discover-notice-reactions .reaction-icon-discover').forEach(icon => {
            icon.addEventListener('click', async () => {
                if (!isAuthenticated) {
                    alert("You need to be authenticated to react.");
                    return;
                }
                const reactionType = icon.dataset.reaction;
                const previousReaction = window.userDiscoverNoticeReactions['discover_notice'];

                try {
                    const updates = {};
                    if (previousReaction) {
                        updates[previousReaction] = increment(-1);
                    }
                    if (previousReaction === reactionType) {
                        window.userDiscoverNoticeReactions['discover_notice'] = null;
                    } else {
                        updates[reactionType] = increment(1);
                        window.userDiscoverNoticeReactions['discover_notice'] = reactionType;
                    }
                    localStorage.setItem('userDiscoverNoticeReactions', JSON.stringify(window.userDiscoverNoticeReactions));
                    await update(discoverNoticeReactionsRef, updates);

                } catch (error) {
                    console.error("Error updating discover notice reaction:", error);
                    alert("Failed to update reaction: " + error.message);
                }
            });
        });
        
        // Expose showRequestCoursesView to the global window object
        window.showRequestCoursesView = function() {
            hideAllViews();
            document.getElementById('request-courses-view').style.display = 'block';
            currentView = 'request-courses-view';
            window.highlightBottomNav('requests-nav'); // Assuming you have a 'requests-nav' for bottom bar
            loadRequestPostsForWebsite();
            window.scrollTo(0, 0);
        };

        function loadRequestPostsForWebsite() {
            const requestPostsContainer = document.getElementById('request-posts-container');
            if (!requestPostsContainer) return;
            requestPostsContainer.innerHTML = `<p class="text-center text-muted col-span-full" id="loadingRequestPostsMessage">Loading community requests...</p>`;
            onValue(dbRef(rtdb, 'requestCourses'), (snapshot) => {
                const requests = snapshot.val() || {};
                requestPostsContainer.innerHTML = ''; 

                if (Object.keys(requests).length === 0) {
                    requestPostsContainer.innerHTML = '<p class="text-center text-muted col-span-full">No community requests available yet.</p>';
                    return;
                }

                const sortedRequests = Object.entries(requests).sort(([, a], [, b]) => (b.timestamp || 0) - (a.timestamp || 0));
                sortedRequests.forEach(([requestId, request]) => {
                    const postCard = document.createElement('div');
                    postCard.className = 'request-post-card';

                    const buttonHtml = request.buttonLink ? `<button class="post-button" onclick="window.open('${request.buttonLink}', '_blank');">${request.buttonText || 'View Details'} <i class="fas fa-external-link-alt"></i></button>` : '';
                    const newTagHtml = request.isNew ? '<span class="new-post-tag">NEW!</span>' : '';

                    postCard.innerHTML = `
                        ${newTagHtml}
                        <div class="post-image-container" onclick="window.openFullscreenImage('${request.imageUrl || ''}')">
                            <img src="${request.imageUrl || 'https://via.placeholder.com/200x200/333333/ffffff?text=No+Image'}" alt="Request Image" onerror="this.onerror=null;this.src='https://via.placeholder.com/200x200/333333/ffffff?text=No+Image';">
                        </div>
                        <div class="post-content">
                            <h3 class="post-title">${request.title || 'Untitled Request'}</h3>
                            <p class="post-description">${request.description || 'No description provided.'}</p>
                            ${buttonHtml}
                            <div class="post-reactions">
                                <span class="reaction-icon-post" data-reaction="❤️" data-postid="${requestId}"><span class="reaction-emoji">❤️</span> <span class="count">${request.reactions?.["❤️"] || 0}</span></span>
                                <span class="reaction-icon-post" data-reaction="😂" data-postid="${requestId}"><span class="reaction-emoji">😂</span> <span class="count">${request.reactions?.["😂"] || 0}</span></span>
                                <span class="reaction-icon-post" data-reaction="👍" data-postid="${requestId}"><span class="reaction-emoji">👍</span> <span class="count">${request.reactions?.["👍"] || 0}</span></span>
                                <span class="reaction-icon-post" data-reaction="🌟" data-postid="${requestId}"><span class="reaction-emoji">🌟</span> <span class="count">${request.reactions?.["🌟"] || 0}</span></span>
                            </div>
                        </div>
                    `;
                    requestPostsContainer.appendChild(postCard);

                    postCard.querySelectorAll('.reaction-icon-post').forEach(icon => {
                        const reactionType = icon.dataset.reaction;
                        if (window.userRequestReactions[requestId] === reactionType) {
                            icon.classList.add('reacted');
                        }

                        icon.addEventListener('click', async () => {
                            if (!isAuthenticated) {
                                alert("You need to be authenticated to react.");
                                return;
                            }
                            const previousReaction = window.userRequestReactions[requestId];
                            
                            try {
                                const updates = {};
                                if (previousReaction && previousReaction !== reactionType) {
                                    updates[`reactions/${previousReaction}`] = increment(-1);
                                }
                                if (previousReaction !== reactionType) {
                                    updates[`reactions/${reactionType}`] = increment(1);
                                    window.userRequestReactions[requestId] = reactionType;
                                } else {
                                    updates[`reactions/${reactionType}`] = increment(-1);
                                    delete window.userRequestReactions[requestId]; 
                                }

                                localStorage.setItem('userRequestReactions', JSON.stringify(window.userRequestReactions));
                                await update(dbRef(rtdb, `requestCourses/${requestId}`), updates);

                            } catch (error) {
                                console.error("Error updating request reaction:", error);
                                alert("Failed to update reaction: " + error.message);
                            }
                        });
                    });
                });
            }, (error) => {
                requestPostsContainer.innerHTML = `<p class="text-center text-muted col-span-full" style="color: var(--error-red);">Error loading community requests: ${error.message}</p>`;
                console.error("Error loading request courses for website:", error);
            });
        }
        
        // Ensure showFullscreenImage and closeFullscreenImage are global
        window.openFullscreenImage = function(src) {
            const overlay = document.getElementById('fullscreenImageOverlay');
            const img = document.getElementById('fullscreenImage');
            if(overlay && img) { 
                img.src = src;
                overlay.classList.add('active');
            }
        };
        window.closeFullscreenImage = function() {
            const overlay = document.getElementById('fullscreenImageOverlay');
            const img = document.getElementById('fullscreenImage');
            if(overlay && img) { 
                overlay.classList.remove('active');
                img.src = ''; 
            }
        };

        // NEW: Copyright Popup functions
        window.showCopyrightPopup = function() {
            document.getElementById('copyrightPopupOverlay').style.display = 'flex';
            document.getElementById('copyrightPopupOverlay').classList.add('active');
        };

        window.closeCopyrightPopup = function() {
            document.getElementById('copyrightPopupOverlay').classList.remove('active');
            setTimeout(() => {
                document.getElementById('copyrightPopupOverlay').style.display = 'none';
            }, 300);
        };
        // END NEW COPYRIGHT POPUP FUNCTIONS

    </script>
</body>
</html>


<!DOCTYPE hml>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SkillNeast Admin Panel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Open+Sans:wght@300;400;600;700&family=Comfortaa:wght@700&family=Poppins:wght@700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            /* Dark Theme Colors */
            --primary-dark: #1a1a1a;
            --secondary-dark: #2c2c2c;
            --bottom-nav-bg: #000000;
            --bottom-nav-item: #ffffff;
            --bottom-nav-active: #00ADB5;
            --card-bg: #222222;
            --text-light: #f0f0f0;
            --text-muted: #b0b0b0;
            --accent-blue: #007bff;
            --accent-teal: #00ADB5;
            --accent-green: #28a745;
            --accent-red: #dc3545;
            --border-color: rgba(255, 255, 255, 0.1);
            --shadow-color: rgba(0, 0, 0, 0.4);
            --input-bg: #333333;
            --input-border: #444444;
            --hover-item: #3a3a3a;
            --quote-text: #E0E0E0;
            --quote-author: #FFD700;
            --highlight-gold: #FFD700;
        }

        body {
            font-family: 'Open Sans', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--primary-dark);
            color: var(--text-light);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .main-wrapper {
            display: flex;
            flex-direction: column;
            width: 100%;
            flex-grow: 1;
            padding-bottom: 70px;
        }

        .content {
            flex-grow: 1;
            padding: 20px;
            position: relative;
        }

        .section {
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 15px var(--shadow-color);
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
            display: none;
        }

        .section.active {
            display: block;
        }

        h2, h5 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            color: var(--accent-teal);
            margin-bottom: 25px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
        }

        .form-control, .form-select, textarea {
            background-color: var(--input-bg);
            border: 1px solid var(--input-border);
            color: var(--text-light);
            border-radius: 8px;
            padding: 10px 15px;
        }
        .form-control:focus, .form-select:focus, textarea:focus {
            background-color: var(--input-bg);
            border-color: var(--accent-teal);
            box-shadow: 0 0 0 0.25rem rgba(0, 173, 181, 0.25);
            color: var(--text-light);
        }
        .form-control::placeholder {
            color: var(--text-muted);
            opacity: 0.7;
        }

        .form-label {
            color: var(--text-light);
            font-weight: 500;
            margin-bottom: 8px;
        }

        .btn-primary, .btn-success, .btn-danger, .btn-secondary, .btn-info {
            border-radius: 25px;
            padding: 10px 25px;
            font-weight: 600;
            transition: all 0.2s ease-in-out;
        }

        .btn-primary { background-color: var(--accent-blue); border-color: var(--accent-blue); }
        .btn-primary:hover { background-color: #0056b3; border-color: #0056b3; transform: translateY(-2px); }

        .btn-success { background-color: var(--accent-green); border-color: var(--accent-green); }
        .btn-success:hover { background-color: #1e7e34; border-color: #1e7e34; transform: translateY(-2px); }

        .btn-danger { background-color: var(--accent-red); border-color: var(--accent-red); }
        .btn-danger:hover { background-color: #c82333; border-color: #bd2130; transform: translateY(-2px); }

        .btn-secondary { background-color: #6c757d; border-color: #6c757d; }
        .btn-secondary:hover { background-color: #5a6268; border-color: #545b62; transform: translateY(-2px); }

        .btn-info { background-color: var(--accent-teal); border-color: var(--accent-teal); }
        .btn-info:hover { background-color: #00939b; border-color: var(--accent-teal); transform: translateY(-2px); }


        .alert {
            margin-top: 15px;
            border-radius: 8px;
            background-color: rgba(0, 173, 181, 0.2);
            border-color: var(--accent-teal);
            color: var(--text-light);
        }
        .alert-danger { background-color: rgba(220, 53, 69, 0.2); border-color: var(--accent-red); }
        .alert-success { background-color: rgba(40, 167, 69, 0.2); border-color: var(--accent-green); }
        .alert-info { background-color: rgba(0, 123, 255, 0.2); border-color: var(--accent-blue); }
        .alert-warning { background-color: rgba(255, 193, 7, 0.2); border-color: #FFC107; color: #FFC107; }




